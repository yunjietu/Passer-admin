import{j as e}from"./jwxt-account-api-qQmGFGXi.js";import{_ as t,s as a}from"./index-ZxpkwSGJ.js";import{d as s}from"./dayjs-CSPdbndm.js";import{b as i}from"./ant-design-vue-DFQN5xdf.js";import{r as o,a as r,b2 as n,ag as l,o as p,bz as d,ai as u,c,b as m,ah as g,J as j,be as f}from"./@vue-wTDZSr7R.js";import"./@ant-design-rHMPkvPq.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./lodash-DJa03WnC.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";const v={style:{"font-size":"12px",color:"#666"}},x={class:"table-container"},y={key:1},h={class:"text-ellipsis",style:{"max-width":"200px",display:"inline-block"}},b=t({__name:"signin-record-modal",setup(t,{expose:b}){const w=o(!1),S=o(!1),z=o([]),I=r({id:null,userCode:"",userName:"",departName:""}),N=r({accountId:null,pageNum:1,pageSize:10}),_=r({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条记录`}),C=[{title:"学号",dataIndex:"userCode",width:150,align:"center"},{title:"姓名",dataIndex:"userName",width:120,align:"center"},{title:"签到日期",dataIndex:"signinDate",width:180,align:"center"},{title:"签到状态",dataIndex:"signinStatus",width:120,align:"center"},{title:"打卡结果",dataIndex:"responseMessage",width:300,align:"left"}];function k(){w.value=!1}function D(e){N.pageNum=e.current,N.pageSize=e.pageSize,M()}async function M(){try{S.value=!0;const t={accountId:N.accountId,pageNum:N.pageNum,pageSize:N.pageSize},a=await e.getSigninRecords(t);a.data&&(z.value=a.data.list||[],_.total=a.data.total||0,_.current=N.pageNum,_.pageSize=N.pageSize)}catch(t){i.error("加载签到记录失败"),a.captureError(t)}finally{S.value=!1}}return b({show:function(e){Object.assign(I,e),N.accountId=I.id,w.value=!0,M()}}),(e,t)=>{const a=n("a-tag"),i=n("a-tooltip"),o=n("a-table"),r=n("a-modal");return p(),l(r,{open:w.value,width:1e3,forceRender:"",footer:null,onCancel:k},{title:d((()=>[u("div",null,[j(" 签到记录 "),u("span",v,f(I.userName)+" - "+f(I.userCode),1)])])),default:d((()=>[u("div",x,[c(o,{dataSource:z.value,columns:C,pagination:_,loading:S.value,rowKey:"id",size:"small",bordered:"",scroll:{x:800},onChange:D},{bodyCell:d((({column:e,record:t,text:o})=>{return["signinStatus"===e.dataIndex?(p(),l(a,{key:0,color:1===t.signinStatus?"success":"error"},{default:d((()=>[j(f(1===t.signinStatus?"成功":"失败"),1)])),_:2},1032,["color"])):"signinDate"===e.dataIndex?(p(),m("span",y,f((r=o,r?s(r).format("YYYY-MM-DD HH:mm"):"")),1)):"responseMessage"===e.dataIndex?(p(),l(i,{key:2,title:o,placement:"topLeft"},{default:d((()=>[u("span",h,f(o||"-"),1)])),_:2},1032,["title"])):g("",!0)];var r})),_:1},8,["dataSource","pagination","loading"])])])),_:1},8,["open"])}}},[["__scopeId","data-v-79eb16c7"]]);export{b as default};
