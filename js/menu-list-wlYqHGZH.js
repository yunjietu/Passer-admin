import{r as e,a,e as t,m as l,b2 as s,z as n,b as o,o as i,c as r,bz as u,y as m,J as d,be as c,E as p,ai as y,ag as f,u as v,K as _,ah as b,b3 as g}from"./@vue-wTDZSr7R.js";import{_ as j}from"./lodash-DJa03WnC.js";import E from"./menu-operate-modal-C6sRsbJz.js";import{f as h,b as x}from"./menu-data-handler-Dl5chp6i.js";import{m as k}from"./menu-api-BSnDUDM1.js";import M from"./index-DPBcXeae.js";import{s as U,M as w,S as I}from"./index-ZxpkwSGJ.js";import{_ as N}from"./index-wy53HiSK.js";import{T as F}from"./table-id-const-CfofKxZg.js";import{M as T,b as C}from"./ant-design-vue-DFQN5xdf.js";import{E as B}from"./@ant-design-rHMPkvPq.js";import"./menu-tree-select-CtRWpHgA.js";import"./@babel-rSvM8Ko2.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./dayjs-CSPdbndm.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./index-072ZJ5LE.js";import"./sortablejs-CRp0PNdb.js";/* empty css                                                                                 */
/*
 *  菜单表格列
 *
 * @Author:    1024创新实验室-主任：小何
 * @Date:      2022-05-12 19:46:11
 * @Wechat:    zhuda1024
 * @Email:     lab1024@163.com
 * @Copyright  1024创新实验室 （ https://1024lab.net ），Since 2012
 */const P=e([{title:"名称",dataIndex:"menuName",key:"ID",width:220},{title:"类型",dataIndex:"menuType",width:100,align:"center"},{title:"图标",dataIndex:"icon",width:50},{title:"路径",dataIndex:"path",ellipsis:!0},{title:"组件",dataIndex:"component",ellipsis:!0},{title:"后端权限",dataIndex:"apiPerms",ellipsis:!0},{title:"前端权限",dataIndex:"webPerms",ellipsis:!0},{title:"顺序",dataIndex:"sort",width:80},{title:"操作",dataIndex:"operate",width:170,align:"center"}]),D={class:"smart-table-operate-block"},A={class:"smart-table-setting-block"},R={key:1},q={key:2},L={key:3},O={key:4},V={key:5},G={key:6},S={key:8,class:"smart-table-operate"},z={__name:"menu-list",setup(z){const $=["red","blue","orange","green"],Y={keywords:"",menuType:void 0,frameFlag:void 0,cacheFlag:void 0,visibleFlag:void 0,disabledFlag:void 0},K=a({...Y}),J=e(!0),W=e(!1),H=e([]);function Q(){Object.assign(K,Y),X()}async function X(){try{W.value=!0;let e=await k.queryMenu();const a=h(e.data,K);H.value=x(a)}catch(e){U.captureError(e)}finally{W.value=!1}}t(X);const Z=e([]);let ee=[];const ae=l((()=>Z.value.length>0));function te(e,a){Z.value=e,ee=a}function le(){se(ee)}function se(e){const a=e.map((e=>e.menuName));T.confirm({title:"确定要删除如下菜单吗?",icon:r(B),content:j.join(a,"、"),okText:"删除",okType:"danger",onOk(){!async function(e){I.show();try{await k.batchDeleteMenu(e),C.success("删除成功!"),X()}catch(a){U.captureError(a)}finally{I.hide()}}(e.map((e=>e.menuId))),ee=[]},cancelText:"取消",onCancel(){}})}const ne=e();function oe(e){ne.value.showDrawer(e)}return(e,a)=>{const t=s("a-input"),l=s("a-form-item"),j=s("SearchOutlined"),h=s("a-button"),x=s("ReloadOutlined"),k=s("a-button-group"),U=s("MoreOutlined"),I=s("a-row"),T=s("a-form"),C=s("PlusOutlined"),B=s("DeleteOutlined"),z=s("a-tag"),Y=s("a-table"),ee=s("a-card"),ie=n("privilege");return i(),o("div",null,[r(T,{class:"smart-query-form"},{default:u((()=>[r(I,{class:"smart-query-form-row"},{default:u((()=>[r(l,{label:"关键字",class:"smart-query-form-item"},{default:u((()=>[r(t,{style:{width:"300px"},value:K.keywords,"onUpdate:value":a[0]||(a[0]=e=>K.keywords=e),placeholder:"菜单名称/路由地址/组件路径/权限字符串"},null,8,["value"])])),_:1}),r(l,{label:"类型",class:"smart-query-form-item"},{default:u((()=>[r(M,{width:"120px",value:K.menuType,"onUpdate:value":a[1]||(a[1]=e=>K.menuType=e),placeholder:"请选择类型","enum-name":"MENU_TYPE_ENUM"},null,8,["value"])])),_:1}),r(l,{label:"禁用",class:"smart-query-form-item"},{default:u((()=>[r(M,{width:"120px","enum-name":"FLAG_NUMBER_ENUM",value:K.disabledFlag,"onUpdate:value":a[2]||(a[2]=e=>K.disabledFlag=e)},null,8,["value"])])),_:1}),r(l,{class:"smart-query-form-item smart-margin-left10"},{default:u((()=>[r(k,null,{default:u((()=>[r(h,{type:"primary",onClick:X},{icon:u((()=>[r(j)])),default:u((()=>[d(" 查询 ")])),_:1}),r(h,{onClick:Q},{icon:u((()=>[r(x)])),default:u((()=>[d(" 重置 ")])),_:1})])),_:1}),r(h,{class:"smart-margin-left20",onClick:a[3]||(a[3]=e=>J.value=!J.value)},{icon:u((()=>[r(U)])),default:u((()=>[d(" "+c(J.value?"收起":"展开"),1)])),_:1})])),_:1})])),_:1}),m(r(I,{class:"smart-query-form-row"},{default:u((()=>[r(l,{label:"外链",class:"smart-query-form-item"},{default:u((()=>[r(M,{width:"120px","enum-name":"FLAG_NUMBER_ENUM",value:K.frameFlag,"onUpdate:value":a[4]||(a[4]=e=>K.frameFlag=e)},null,8,["value"])])),_:1}),r(l,{label:"缓存",class:"smart-query-form-item"},{default:u((()=>[r(M,{width:"120px","enum-name":"FLAG_NUMBER_ENUM",value:K.cacheFlag,"onUpdate:value":a[5]||(a[5]=e=>K.cacheFlag=e)},null,8,["value"])])),_:1}),r(l,{label:"显示",class:"smart-query-form-item"},{default:u((()=>[r(M,{width:"120px","enum-name":"FLAG_NUMBER_ENUM",value:K.visibleFlag,"onUpdate:value":a[6]||(a[6]=e=>K.visibleFlag=e)},null,8,["value"])])),_:1})])),_:1},512),[[p,J.value]])])),_:1}),r(ee,{size:"small",bordered:!1,hoverable:!0},{default:u((()=>[r(I,{class:"smart-table-btn-block"},{default:u((()=>[y("div",D,[m((i(),f(h,{type:"primary",onClick:oe},{icon:u((()=>[r(C)])),default:u((()=>[d(" 添加菜单 ")])),_:1})),[[ie,"system:menu:add"]]),m((i(),f(h,{type:"primary",danger:"",onClick:le,disabled:!ae.value},{icon:u((()=>[r(B)])),default:u((()=>[d(" 批量删除 ")])),_:1},8,["disabled"])),[[ie,"system:menu:batchDelete"]])]),y("div",A,[r(N,{modelValue:v(P),"onUpdate:modelValue":a[7]||(a[7]=e=>_(P)?P.value=e:null),tableId:v(F).SYSTEM.MENU,refresh:X},null,8,["modelValue","tableId"])])])),_:1}),r(Y,{"row-selection":{selectedRowKeys:Z.value,onChange:te},size:"small",scroll:{y:800},defaultExpandAllRows:!0,dataSource:H.value,bordered:"",columns:v(P),loading:W.value,rowKey:"menuId",pagination:!1},{bodyCell:u((({text:a,record:t,column:l})=>["menuType"===l.dataIndex?(i(),f(z,{key:0,color:$[a]},{default:u((()=>[d(c(e.$smartEnumPlugin.getDescByValue("MENU_TYPE_ENUM",a)),1)])),_:2},1032,["color"])):b("",!0),"component"===l.dataIndex?(i(),o("span",R,c(t.frameFlag?t.frameUrl:t.component),1)):b("",!0),"frameFlag"===l.dataIndex?(i(),o("span",q,c(e.$smartEnumPlugin.getDescByValue("FLAG_NUMBER_ENUM",a)),1)):b("",!0),"permsType"===l.dataIndex?(i(),o("span",L,c(e.$smartEnumPlugin.getDescByValue("MENU_PERMS_TYPE_ENUM",a)),1)):b("",!0),"cacheFlag"===l.dataIndex?(i(),o("span",O,c(e.$smartEnumPlugin.getDescByValue("FLAG_NUMBER_ENUM",a)),1)):b("",!0),"visibleFlag"===l.dataIndex?(i(),o("span",V,c(e.$smartEnumPlugin.getDescByValue("FLAG_NUMBER_ENUM",a)),1)):b("",!0),"disabledFlag"===l.dataIndex?(i(),o("span",G,c(e.$smartEnumPlugin.getDescByValue("FLAG_NUMBER_ENUM",a)),1)):b("",!0),"icon"===l.dataIndex?(i(),f(g(e.$antIcons[a]),{key:7})):b("",!0),"operate"===l.dataIndex?(i(),o("div",S,[t.menuType!==v(w).POINTS.value?m((i(),f(h,{key:0,type:"link",size:"small",onClick:e=>function(e){const a={parentId:e.menuId,menuType:e.menuType===w.CATALOG.value?w.MENU.value:w.POINTS.value,contextMenuId:e.menuType===w.MENU.value?e.menuId:void 0};ne.value.showDrawer(a)}(t)},{default:u((()=>[d(" 添加下级 ")])),_:2},1032,["onClick"])),[[ie,"system:menu:update"]]):b("",!0),m((i(),f(h,{type:"link",size:"small",onClick:e=>oe(t)},{default:u((()=>[d("编辑")])),_:2},1032,["onClick"])),[[ie,"system:menu:update"]]),m((i(),f(h,{danger:"",type:"link",onClick:e=>function(e){se([e])}(t)},{default:u((()=>[d("删除")])),_:2},1032,["onClick"])),[[ie,"system:menu:batchDelete"]])])):b("",!0)])),_:1},8,["row-selection","dataSource","columns","loading"])])),_:1}),r(E,{ref_key:"menuOperateModal",ref:ne,onReloadList:X},null,512)])}}};export{z as default};
