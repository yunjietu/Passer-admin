import{P as e,y as a,s as t,S as s}from"./index-ZxpkwSGJ.js";import l from"./index-DPBcXeae.js";import{_ as i}from"./index-wy53HiSK.js";import r from"./message-send-form-8O7bqAPe.js";import{T as o}from"./table-id-const-CfofKxZg.js";import{M as n,b as d}from"./ant-design-vue-DFQN5xdf.js";import{r as m,a as u,e as p,b2 as c,b as g,o as f,c as y,bz as j,J as v,ai as h,u as b,ah as _,F as x,be as w}from"./@vue-wTDZSr7R.js";import"./@ant-design-rHMPkvPq.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./lodash-DJa03WnC.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./dayjs-CSPdbndm.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./sortablejs-CRp0PNdb.js";/* empty css                                                                                 */import"./message-receiver-modal-TsypYnim.js";const S={class:"smart-table-operate-block"},z={class:"smart-table-setting-block"},k={key:2,class:"smart-table-operate"},I={class:"smart-query-table-page"},T={__name:"message-list",setup(T){const E=m([{title:"消息类型",dataIndex:"messageType",ellipsis:!0,width:100},{title:"消息标题",dataIndex:"title",ellipsis:!0},{title:"消息内容",dataIndex:"content",ellipsis:!0},{title:"接收人ID",dataIndex:"receiverUserId",ellipsis:!0,width:100},{title:"已读",dataIndex:"readFlag",width:50},{title:"已读时间",dataIndex:"readTime",width:150},{title:"创建时间",dataIndex:"createTime",width:150},{title:"操作",dataIndex:"action",fixed:"right",width:60}]),U={searchWord:void 0,pageNum:1,pageSize:10,createTime:[],readFlag:null,startDate:null,endDate:null,messageType:null};function C(e,a){M.startDate=a[0],M.endDate=a[1]}const M=u({...U}),q=m(!1),P=m([]),N=m(0);function O(){let e=M.pageSize;Object.assign(M,U),M.pageSize=e,F()}function D(){M.pageNum=1,F()}async function F(){q.value=!0;try{let e=await a.queryAdminMessage(M);P.value=e.data.list,N.value=e.data.total}catch(e){t.captureError(e)}finally{q.value=!1}}p(F);const A=m();function R(e){A.value.show(e)}function V(e){n.confirm({title:"提示",content:"确定要删除选吗?",okText:"删除",okType:"danger",onOk(){!async function(e){try{s.show(),await a.deleteMessage(e.messageId),d.success("删除成功"),F()}catch(l){t.captureError(l)}finally{s.hide()}}(e)},cancelText:"取消",onCancel(){}})}return(a,t)=>{const s=c("a-input"),n=c("a-form-item"),d=c("a-range-picker"),m=c("SearchOutlined"),u=c("a-button"),p=c("ReloadOutlined"),T=c("a-row"),U=c("a-form"),G=c("PlusOutlined"),L=c("a-table"),W=c("a-pagination"),B=c("a-card");return f(),g(x,null,[y(U,{class:"smart-query-form"},{default:j((()=>[y(T,{class:"smart-query-form-row"},{default:j((()=>[y(n,{label:"关键词",class:"smart-query-form-item"},{default:j((()=>[y(s,{style:{width:"150px"},value:M.searchWord,"onUpdate:value":t[0]||(t[0]=e=>M.searchWord=e),placeholder:"关键词"},null,8,["value"])])),_:1}),y(n,{label:"类型",class:"smart-query-form-item"},{default:j((()=>[y(l,{style:{width:"150px"},value:M.messageType,"onUpdate:value":t[1]||(t[1]=e=>M.messageType=e),placeholder:"消息类型","enum-name":"MESSAGE_TYPE_ENUM"},null,8,["value"])])),_:1}),y(n,{label:"是否已读",class:"smart-query-form-item"},{default:j((()=>[y(l,{width:"120px","enum-name":"FLAG_NUMBER_ENUM",value:M.readFlag,"onUpdate:value":t[2]||(t[2]=e=>M.readFlag=e)},null,8,["value"])])),_:1}),y(n,{label:"创建时间",class:"smart-query-form-item"},{default:j((()=>[y(d,{value:M.createTime,"onUpdate:value":t[3]||(t[3]=e=>M.createTime=e),style:{width:"200px"},onChange:C},null,8,["value"])])),_:1}),y(n,{class:"smart-query-form-item"},{default:j((()=>[y(u,{type:"primary",onClick:D},{icon:j((()=>[y(m)])),default:j((()=>[v(" 查询 ")])),_:1}),y(u,{onClick:O,class:"smart-margin-left10"},{icon:j((()=>[y(p)])),default:j((()=>[v(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1}),y(B,{size:"small",bordered:!1,hoverable:!0},{default:j((()=>[y(T,{class:"smart-table-btn-block"},{default:j((()=>[h("div",S,[y(u,{onClick:R,type:"primary"},{icon:j((()=>[y(G)])),default:j((()=>[v(" 发送消息 ")])),_:1})]),h("div",z,[y(i,{modelValue:E.value,"onUpdate:modelValue":t[4]||(t[4]=e=>E.value=e),tableId:b(o).SUPPORT.MAIL,refresh:F},null,8,["modelValue","tableId"])])])),_:1}),y(L,{size:"small",dataSource:P.value,columns:E.value,rowKey:"telephoneId",bordered:"",loading:q.value,pagination:!1},{bodyCell:j((({record:e,column:t,text:s})=>["readFlag"===t.dataIndex?(f(),g(x,{key:0},[v(w(s?"已读":"未读"),1)],64)):_("",!0),"messageType"===t.dataIndex?(f(),g(x,{key:1},[v(w(a.$smartEnumPlugin.getDescByValue("MESSAGE_TYPE_ENUM",s)),1)],64)):_("",!0),"action"===t.dataIndex?(f(),g("div",k,[y(u,{onClick:a=>V(e),danger:"",type:"link"},{default:j((()=>[v("删除")])),_:2},1032,["onClick"])])):_("",!0)])),_:1},8,["dataSource","columns","loading"]),h("div",I,[y(W,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:b(e),defaultPageSize:M.pageSize,current:M.pageNum,"onUpdate:current":t[5]||(t[5]=e=>M.pageNum=e),pageSize:M.pageSize,"onUpdate:pageSize":t[6]||(t[6]=e=>M.pageSize=e),total:N.value,onChange:F,onShowSizeChange:F,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])]),y(r,{ref_key:"formRef",ref:A,onReloadList:F},null,512)])),_:1})],64)}}};export{T as default};
