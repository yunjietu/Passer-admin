import{n as e}from"./notice-api-DZe8g0W4.js";import{c as t,P as a}from"./index-ZxpkwSGJ.js";import{_ as i}from"./index-YdqzJmk0.js";import{u as o}from"./ua-parser-js-BGt8dhPM.js";import{r as s,a as r,b2 as n,b as l,o as p,c as d,ai as m,bz as u,J as c,ah as f,F as j,be as g,u as v}from"./@vue-wTDZSr7R.js";import"./ant-design-vue-DFQN5xdf.js";import"./@babel-rSvM8Ko2.js";import"./@ant-design-rHMPkvPq.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./dayjs-CSPdbndm.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./lodash-DJa03WnC.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./department-api-BBQ_I4Vj.js";const y={class:"smart-query-table-page"},I={__name:"notice-view-record-list",props:{noticeId:{type:[Number,String]}},setup(I,{expose:h}){const w=I;h({onSearch:D});const b=[{title:"账号ID",dataIndex:"employeeId"},{title:"查看次数",dataIndex:"pageViewCount"},{title:"首次查看设备",dataIndex:"firstIp"},{title:"首次查看时间",dataIndex:"createTime"},{title:"最后一次查看设备",dataIndex:"lastIp"},{title:"最后一次查看时间",dataIndex:"updateTime",with:80}],x=s([]),S=s(0),z=s(!1),_={noticeId:w.noticeId,departmentId:null,keywords:"",pageNum:1,pageSize:t},k=r({..._});function C(e){if(!e)return"";let t=o(e);return t.browser.name+"/"+t.os.name+"/"+(t.device.vendor?t.device.vendor+t.device.model:"")}async function q(){try{z.value=!0;const t=await e.queryViewRecord(k);for(const e of t.data.list)e.firstDevice=C(e.firstUserAgent),e.lastDevice=C(e.lastUserAgent);x.value=t.data.list,S.value=t.data.total}catch(t){}finally{z.value=!1}}function D(){k.pageNum=1,q()}function N(){Object.assign(k,_),q()}return(e,t)=>{const o=n("a-form-item"),s=n("a-input"),r=n("SearchOutlined"),I=n("a-button"),h=n("ReloadOutlined"),w=n("a-button-group"),_=n("a-row"),C=n("a-form"),U=n("a-table"),O=n("a-pagination");return p(),l("div",null,[d(C,{class:"smart-query-form"},{default:u((()=>[d(_,{class:"smart-query-form-row"},{default:u((()=>[d(o,{label:"部门",class:"smart-query-form-item",style:{width:"280px","margin-right":"20px"}},{default:u((()=>[d(i,{value:k.departmentId,"onUpdate:value":t[0]||(t[0]=e=>k.departmentId=e),width:"100%"},null,8,["value"])])),_:1}),d(o,{label:"关键字",class:"smart-query-form-item",style:{width:"280px"}},{default:u((()=>[d(s,{value:k.keywords,"onUpdate:value":t[1]||(t[1]=e=>k.keywords=e),placeholder:"账号ID/IP/设备"},null,8,["value"])])),_:1}),d(o,{class:"smart-query-form-item smart-margin-left10"},{default:u((()=>[d(w,null,{default:u((()=>[d(I,{type:"primary",onClick:D},{icon:u((()=>[d(r)])),default:u((()=>[c(" 查询 ")])),_:1}),d(I,{onClick:N},{icon:u((()=>[d(h)])),default:u((()=>[c(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),d(U,{rowKey:"employeeId",columns:b,dataSource:x.value,pagination:!1,loading:z.value,size:"small",bordered:""},{bodyCell:u((({column:e,record:t,text:a})=>["employeeId"===e.dataIndex?(p(),l(j,{key:0},[c(g(a)+"("+g(t.departmentName)+") ",1)],64)):f("",!0),"firstIp"===e.dataIndex?(p(),l(j,{key:1},[c(g(a)+" ("+g(t.firstDevice)+") ",1)],64)):f("",!0),"lastIp"===e.dataIndex?(p(),l(j,{key:2},[c(g(a)+" ("+g(t.lastDevice)+") ",1)],64)):f("",!0)])),_:1},8,["dataSource","loading"]),m("div",y,[d(O,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:v(a),defaultPageSize:k.pageSize,current:k.pageNum,"onUpdate:current":t[2]||(t[2]=e=>k.pageNum=e),pageSize:k.pageSize,"onUpdate:pageSize":t[3]||(t[3]=e=>k.pageSize=e),total:S.value,onChange:q,onShowSizeChange:q,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])])])}}};export{I as default};
