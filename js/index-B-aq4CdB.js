import{O as e,o as a}from"./operate-log-detail-modal-B-KXA4-n.js";import{P as t,s}from"./index-ZxpkwSGJ.js";import{d as o}from"./default-time-ranges-uUNYRUiy.js";import{u as i}from"./ua-parser-js-BGt8dhPM.js";import{r,a as l,e as n,b2 as u,b as d,o as p,c as m,ai as c,bz as g,u as v,J as f,ag as j,ah as y,be as h,F as b}from"./@vue-wTDZSr7R.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./ant-design-vue-DFQN5xdf.js";import"./@babel-rSvM8Ko2.js";import"./@ant-design-rHMPkvPq.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./dayjs-CSPdbndm.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./lodash-DJa03WnC.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";const w={key:1},x={key:2,class:"smart-table-operate"},_={class:"smart-query-table-page"},z={__name:"index",setup(z){const S=r([{title:"操作模块",dataIndex:"module",ellipsis:!0,width:120},{title:"操作内容",dataIndex:"content",ellipsis:!0},{title:"IP地区",dataIndex:"ipRegion",ellipsis:!0,width:120},{title:"客户端",dataIndex:"userAgent",ellipsis:!0,width:140},{title:"时间",dataIndex:"createTime",width:150},{title:"结果",dataIndex:"successFlag",width:60},{title:"操作",dataIndex:"action",fixed:"right",width:60}]),I={userName:"",successFlag:void 0,startDate:void 0,endDate:void 0,pageNum:1,pageSize:10},k=l({...I}),C=r([]),q=o;function F(e,a){k.startDate=a[0],k.endDate=a[1]}const O=r(!1),D=r([]),N=r(0);function A(){Object.assign(k,I),C.value=[],P()}function L(){k.pageNum=1,P()}async function P(){try{O.value=!0;let e=await a.queryListLogin(k);for(const a of e.data.list){if(!a.userAgent)continue;let e=i(a.userAgent);a.browser=e.browser.name,a.os=e.os.name,a.device=e.device.vendor?e.device.vendor+e.device.model:""}const t=e.data.list;N.value=e.data.total,D.value=t}catch(e){s.captureError(e)}finally{O.value=!1}}n(P);const U=r();return(a,s)=>{const o=u("a-range-picker"),i=u("a-form-item"),r=u("a-radio-button"),l=u("a-radio-group"),n=u("SearchOutlined"),z=u("a-button"),I=u("ReloadOutlined"),E=u("a-button-group"),J=u("a-row"),R=u("a-form"),B=u("a-tag"),K=u("a-table"),M=u("a-pagination");return p(),d(b,null,[m(R,{class:"smart-query-form"},{default:g((()=>[m(J,{class:"smart-query-form-row"},{default:g((()=>[m(i,{label:"请求时间",class:"smart-query-form-item"},{default:g((()=>[m(o,{onChange:F,value:C.value,"onUpdate:value":s[0]||(s[0]=e=>C.value=e),presets:v(q),style:{width:"240px"}},null,8,["value","presets"])])),_:1}),m(i,{label:"快速筛选",class:"smart-query-form-item"},{default:g((()=>[m(l,{value:k.successFlag,"onUpdate:value":s[1]||(s[1]=e=>k.successFlag=e),onChange:L},{default:g((()=>[m(r,{value:void 0},{default:g((()=>[f("全部")])),_:1}),m(r,{value:!0},{default:g((()=>[f("成功")])),_:1}),m(r,{value:!1},{default:g((()=>[f("失败")])),_:1})])),_:1},8,["value"])])),_:1}),m(i,{class:"smart-query-form-item smart-margin-left10"},{default:g((()=>[m(E,null,{default:g((()=>[m(z,{type:"primary",onClick:P},{icon:g((()=>[m(n)])),default:g((()=>[f(" 查询 ")])),_:1}),m(z,{onClick:A},{icon:g((()=>[m(I)])),default:g((()=>[f(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),m(K,{size:"small",loading:O.value,dataSource:D.value,columns:S.value,bordered:"",rowKey:"operateLogId",pagination:!1},{bodyCell:g((({text:e,record:a,column:t})=>["successFlag"===t.dataIndex?(p(),j(B,{key:0,color:e?"success":"error"},{default:g((()=>[f(h(e?"成功":"失败"),1)])),_:2},1032,["color"])):y("",!0),"userAgent"===t.dataIndex?(p(),d("div",w,h(a.browser)+" / "+h(a.os)+" / "+h(a.device),1)):y("",!0),"action"===t.dataIndex?(p(),d("div",x,[m(z,{onClick:e=>{return t=a.operateLogId,void U.value.show(t);var t},type:"link"},{default:g((()=>[f("详情")])),_:2},1032,["onClick"])])):y("",!0)])),_:1},8,["loading","dataSource","columns"]),c("div",_,[m(M,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:v(t),defaultPageSize:k.pageSize,current:k.pageNum,"onUpdate:current":s[2]||(s[2]=e=>k.pageNum=e),pageSize:k.pageSize,"onUpdate:pageSize":s[3]||(s[3]=e=>k.pageSize=e),total:N.value,onChange:P,onShowSizeChange:P,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])]),m(e,{ref_key:"detailModal",ref:U},null,512)],64)}}};export{z as default};
