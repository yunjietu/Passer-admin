import{_ as e}from"./index-0_dkeot7.js";import{_ as t}from"./lodash-DJa03WnC.js";import{e as a}from"./enterprise-api-BssaVI4u.js";import{_ as s,c as o,d as i,P as l,s as r,S as n}from"./index-ZxpkwSGJ.js";import{_ as d}from"./index-wy53HiSK.js";import{T as p}from"./table-id-const-CfofKxZg.js";import{M as m,b as u}from"./ant-design-vue-DFQN5xdf.js";import{a as c,r as y,m as g,w as f,b2 as j,z as v,b as h,o as w,ai as b,c as I,J as _,bz as E,y as x,ag as k,u as S,ah as z,be as C}from"./@vue-wTDZSr7R.js";import"./index-YdqzJmk0.js";import"./department-api-BBQ_I4Vj.js";import"./@ant-design-rHMPkvPq.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./dayjs-CSPdbndm.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./sortablejs-CRp0PNdb.js";/* empty css                                                                                 */const N={class:"header"},T={key:1},P={class:"smart-query-table-page"},L=s({__name:"enterprise-employee-list",props:{enterpriseId:{type:Number,default:null}},setup(s){const L=s,O=c([{title:"姓名",dataIndex:"actualName"},{title:"手机号",dataIndex:"phone",width:120},{title:"登录账号",dataIndex:"loginName"},{title:"企业",dataIndex:"enterpriseName",ellipsis:!0},{title:"部门",dataIndex:"departmentName",ellipsis:!0},{title:"状态",dataIndex:"disabledFlag",width:80},{title:"操作",dataIndex:"operate",width:90,align:"center"}]),U=c({...{pageNum:1,pageSize:o,enterpriseId:void 0,keyword:void 0}}),M=y(0),D=y([]),R=y(!1);function V(){U.keyword="",A()}function q(){U.pageNum=1,A()}async function A(){try{R.value=!0,U.enterpriseId=L.enterpriseId;let e=await a.queryPageEmployeeList(U);D.value=e.data.list,M.value=e.data.total}catch(e){r.captureError(e)}finally{R.value=!1}}async function B(e){if(t.isEmpty(e))u.warning("请选择员工");else{n.show();try{let t={employeeIdList:e,enterpriseId:L.enterpriseId};await a.addEmployee(t),u.success("添加成功"),await A()}catch(s){r.captureError(s)}finally{n.hide()}}}const F=y();async function J(){let e=(await a.employeeList([L.enterpriseId])).data.map((e=>e.employeeId))||[];F.value.showModal(e)}const K=y([]),G=g((()=>K.value.length>0));function Q(e){K.value=e}function Y(){G.value?m.confirm({title:"提示",content:"确定要删除该企业下的员工么？",okText:"确定",okType:"danger",async onOk(){n.show();try{let e={employeeIdList:K.value,enterpriseId:L.enterpriseId};await a.deleteEmployee(e),u.success("移除成功"),K.value=[],await A()}catch(e){r.captureError(e)}finally{n.hide()}},cancelText:"取消",onCancel(){}}):u.warning("请选择要删除的员工")}return f((()=>L.enterpriseId),(e=>{e&&A()}),{immediate:!0}),(t,s)=>{const o=j("a-input"),c=j("a-button"),y=j("a-row"),g=j("a-tag"),f=j("a-table"),G=j("a-pagination"),$=j("a-card"),H=v("privilege");return w(),h("div",null,[b("div",N,[b("div",null,[_(" 关键字： "),I(o,{style:{width:"250px"},value:U.keyword,"onUpdate:value":s[0]||(s[0]=e=>U.keyword=e),placeholder:"姓名/手机号/登录账号"},null,8,["value"]),I(c,{class:"button-style",type:"primary",onClick:q},{default:E((()=>[_("搜索")])),_:1}),I(c,{class:"button-style",type:"default",onClick:V},{default:E((()=>[_("重置")])),_:1})]),b("div",null,[x((w(),k(c,{class:"button-style",type:"primary",onClick:J},{default:E((()=>[_(" 添加员工 ")])),_:1})),[[H,"oa:enterprise:addEmployee"]]),x((w(),k(c,{class:"button-style",type:"primary",danger:"",onClick:Y},{default:E((()=>[_(" 批量移除 ")])),_:1})),[[H,"oa:enterprise:deleteEmployee"]])])]),I($,{size:"small",bordered:!1,hoverable:!1},{default:E((()=>[I(y,{justify:"end"},{default:E((()=>[I(d,{class:"smart-margin-bottom5",modelValue:O,"onUpdate:modelValue":s[1]||(s[1]=e=>O=e),tableId:S(p).BUSINESS.OA.ENTERPRISE_EMPLOYEE,refresh:A},null,8,["modelValue","tableId"])])),_:1}),I(f,{loading:R.value,dataSource:D.value,columns:O,pagination:!1,rowKey:"employeeId","row-selection":{selectedRowKeys:K.value,onChange:Q},size:"small",bordered:""},{bodyCell:E((({text:e,record:s,column:o})=>["disabledFlag"===o.dataIndex?(w(),k(g,{key:0,color:e?"error":"processing"},{default:E((()=>[_(C(e?"禁用":"启用"),1)])),_:2},1032,["color"])):"gender"===o.dataIndex?(w(),h("span",T,C(t.$smartEnumPlugin.getDescByValue("GENDER_ENUM",e)),1)):z("",!0),"operate"===o.dataIndex?x((w(),k(c,{key:2,type:"link",onClick:e=>async function(e){m.confirm({title:"提示",content:"确定要删除该企业下的员工么？",okText:"确定",okType:"danger",async onOk(){n.show();try{let t={employeeIdList:[e],enterpriseId:L.enterpriseId};await a.deleteEmployee(t),u.success("移除成功"),await A()}catch(t){r.captureError(t)}finally{n.hide()}},cancelText:"取消",onCancel(){}})}(s.employeeId)},{default:E((()=>[_("移除")])),_:2},1032,["onClick"])),[[H,"oa:enterprise:deleteEmployee"]]):z("",!0)])),_:1},8,["loading","dataSource","columns","row-selection"]),b("div",P,[I(G,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:S(l),defaultPageSize:U.pageSize,current:U.pageNum,"onUpdate:current":s[2]||(s[2]=e=>U.pageNum=e),pageSize:U.pageSize,"onUpdate:pageSize":s[3]||(s[3]=e=>U.pageSize=e),total:M.value,onChange:A,onShowSizeChange:A,"show-total":S(i)},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])]),I(e,{ref_key:"selectEmployeeModal",ref:F,onSelectData:B},null,512)])),_:1})])}}},[["__scopeId","data-v-fcbf79f8"]]);export{L as default};
