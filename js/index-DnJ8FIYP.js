import{_ as e}from"./lodash-DJa03WnC.js";import{s as a,_ as t,E as l,S as o,h as r}from"./index-ZxpkwSGJ.js";import{r as i}from"./role-api-w0pDqSQW.js";import{_ as s}from"./index-YdqzJmk0.js";import n from"./index-DPBcXeae.js";import{p as u}from"./position-api-DEFSEgaB.js";import{r as d,e as p,w as m,b2 as c,ag as v,o as f,bz as g,b as h,F as y,b0 as j,J as b,be as _,aR as w,a as I,c as N,ai as x,u as E,ah as U,n as q,aY as F,aW as k}from"./@vue-wTDZSr7R.js";import{r as C}from"./regular-const-BsnQI0fZ.js";import{b as z}from"./ant-design-vue-DFQN5xdf.js";import"./@ant-design-rHMPkvPq.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./dayjs-CSPdbndm.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./department-api-BBQ_I4Vj.js";const M={__name:"index",props:{value:[Number,Array],placeholder:{type:String,default:"请选择"},width:{type:String,default:"100%"},size:{type:String,default:"default"}},emits:["update:value","change"],setup(e,{emit:t}){const l=e,o=t,r=d([]);p((async function(){try{let e=await u.queryList();r.value=e.data}catch(e){a.captureError(e)}}));const i=d(l.value);function s(e){o("update:value",e),o("change",e)}return m((()=>l.value),(e=>{i.value=e})),(a,t)=>{const o=c("a-select-option"),n=c("a-select");return f(),v(n,{value:i.value,"onUpdate:value":t[0]||(t[0]=e=>i.value=e),style:w(`width: ${e.width}`),placeholder:l.placeholder,showSearch:!0,allowClear:!0,size:e.size,onChange:s},{default:g((()=>[(f(!0),h(y,null,j(r.value,(e=>(f(),v(o,{key:e.positionId,value:e.positionId},{default:g((()=>[b(_(e.positionName),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value","style","placeholder","size"])}}},S=(e=>(F("data-v-111bfbf7"),e=e(),k(),e))((()=>x("p",{class:"hint"},"初始密码默认为：随机",-1))),L={class:"footer"},D=t({__name:"index",emits:["refresh","show-account"],setup(t,{expose:u,emit:p}){const m=d(),w=p,F=d(!1);function k(){P(),F.value=!1}const D=d([]);const O=d(),A={employeeId:void 0,actualName:void 0,departmentId:void 0,disabledFlag:0,leaveFlag:0,gender:l.MAN.value,loginName:void 0,phone:void 0,roleIdList:void 0,positionId:void 0,email:void 0};let R=I(e.cloneDeep(A));function P(){Object.assign(R,A),O.value.resetFields()}const B={actualName:[{required:!0,message:"姓名不能为空"},{max:30,message:"姓名不能大于30个字符",trigger:"blur"}],phone:[{required:!0,message:"手机号不能为空"},{pattern:C.phone,message:"请输入正确的手机号码",trigger:"blur"}],loginName:[{required:!0,message:"登录账号不能为空"},{max:30,message:"登录账号不能大于30个字符",trigger:"blur"}],gender:[{required:!0,message:"性别不能为空"}],departmentId:[{required:!0,message:"部门不能为空"}],disabledFlag:[{required:!0,message:"状态不能为空"}],leaveFlag:[{required:!0,message:"在职状态不能为空"}],email:[{required:!0,message:"请输入邮箱"}]};async function G(e){let t=await function(e){return new Promise((a=>{e.validate().then((()=>{a(!0)})).catch((()=>{a(!1)}))}))}(O.value);t?(o.show(),R.employeeId?await async function(e){try{await r.updateEmployee(R);z.success("更新成功"),e?P():k(),w("refresh")}catch(t){a.captureError(t)}finally{o.hide()}}(e):await async function(e){try{let{data:a}=await r.addEmployee(R);z.success("添加成功"),w("show-account",R.loginName,a),e?P():k(),w("refresh")}catch(t){a.captureError(t)}finally{o.hide()}}(e)):z.error("参数验证错误，请仔细填写表单数据!")}return u({showDrawer:async function(a){Object.assign(R,A),a&&!e.isEmpty(a)&&Object.assign(R,a),F.value=!0,q((()=>{!async function(){let e=await i.queryAll();D.value=e.data}()}))}}),(e,a)=>{const t=c("a-input"),l=c("a-form-item"),o=c("a-select-option"),r=c("a-select"),i=c("a-form"),u=c("a-button"),d=c("a-drawer");return f(),v(d,{title:E(R).employeeId?"编辑":"添加",width:600,open:F.value,"body-style":{paddingBottom:"80px"},onClose:k,destroyOnClose:""},{default:g((()=>[N(i,{ref_key:"formRef",ref:O,model:E(R),rules:B,layout:"vertical"},{default:g((()=>[N(l,{label:"姓名",name:"actualName"},{default:g((()=>[N(t,{value:E(R).actualName,"onUpdate:value":a[0]||(a[0]=e=>E(R).actualName=e),valueModifiers:{trim:!0},placeholder:"请输入姓名"},null,8,["value"])])),_:1}),N(l,{label:"手机号",name:"phone"},{default:g((()=>[N(t,{value:E(R).phone,"onUpdate:value":a[1]||(a[1]=e=>E(R).phone=e),valueModifiers:{trim:!0},placeholder:"请输入手机号"},null,8,["value"])])),_:1}),N(l,{label:"部门",name:"departmentId"},{default:g((()=>[N(s,{ref_key:"departmentTreeSelect",ref:m,width:"100%",init:!1,value:E(R).departmentId,"onUpdate:value":a[2]||(a[2]=e=>E(R).departmentId=e)},null,8,["value"])])),_:1}),N(l,{label:"登录名",name:"loginName"},{default:g((()=>[N(t,{value:E(R).loginName,"onUpdate:value":a[3]||(a[3]=e=>E(R).loginName=e),valueModifiers:{trim:!0},placeholder:"请输入登录名"},null,8,["value"]),S])),_:1}),N(l,{label:"邮箱",name:"email"},{default:g((()=>[N(t,{value:E(R).email,"onUpdate:value":a[4]||(a[4]=e=>E(R).email=e),valueModifiers:{trim:!0},placeholder:"请输入邮箱"},null,8,["value"])])),_:1}),N(l,{label:"性别",name:"gender"},{default:g((()=>[N(n,{style:{width:"100%"},value:E(R).gender,"onUpdate:value":a[5]||(a[5]=e=>E(R).gender=e),placeholder:"请选择性别","enum-name":"GENDER_ENUM"},null,8,["value"])])),_:1}),N(l,{label:"状态",name:"disabledFlag"},{default:g((()=>[N(r,{value:E(R).disabledFlag,"onUpdate:value":a[6]||(a[6]=e=>E(R).disabledFlag=e),placeholder:"请选择状态"},{default:g((()=>[N(o,{value:0},{default:g((()=>[b("启用")])),_:1}),N(o,{value:1},{default:g((()=>[b("禁用")])),_:1})])),_:1},8,["value"])])),_:1}),N(l,{label:"职务",name:"positionId"},{default:g((()=>[N(M,{value:E(R).positionId,"onUpdate:value":a[7]||(a[7]=e=>E(R).positionId=e),placeholder:"请选择职务"},null,8,["value"])])),_:1}),N(l,{label:"角色",name:"roleIdList"},{default:g((()=>[N(r,{mode:"multiple",value:E(R).roleIdList,"onUpdate:value":a[8]||(a[8]=e=>E(R).roleIdList=e),optionFilterProp:"title",placeholder:"请选择角色"},{default:g((()=>[(f(!0),h(y,null,j(D.value,(e=>(f(),v(o,{key:e.roleId,title:e.roleName},{default:g((()=>[b(_(e.roleName),1)])),_:2},1032,["title"])))),128))])),_:1},8,["value"])])),_:1})])),_:1},8,["model"]),x("div",L,[N(u,{style:{"margin-right":"8px"},onClick:k},{default:g((()=>[b("取消")])),_:1}),N(u,{type:"primary",style:{"margin-right":"8px"},onClick:a[9]||(a[9]=e=>G(!1))},{default:g((()=>[b("保存")])),_:1}),E(R).employeeId?U("",!0):(f(),v(u,{key:0,type:"primary",onClick:a[10]||(a[10]=e=>G(!0))},{default:g((()=>[b("保存并继续添加")])),_:1}))])])),_:1},8,["title","open"])}}},[["__scopeId","data-v-111bfbf7"]]);export{D as default};
