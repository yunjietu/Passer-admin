import{P as e,U as a,F as t,i as l,s as i}from"./index-ZxpkwSGJ.js";import o from"./index-DPBcXeae.js";import{_ as r}from"./index-wy53HiSK.js";import{d as s}from"./default-time-ranges-uUNYRUiy.js";import{F as d}from"./index-BgOQS_he.js";import{r as n,a as u,e as p,b2 as m,z as c,b as f,o as y,y as v,c as h,ag as g,bz as j,u as _,J as b,ai as w,ah as x,be as z,F as S}from"./@vue-wTDZSr7R.js";import"./ant-design-vue-DFQN5xdf.js";import"./@babel-rSvM8Ko2.js";import"./@ant-design-rHMPkvPq.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./dayjs-CSPdbndm.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./lodash-DJa03WnC.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./sortablejs-CRp0PNdb.js";/* empty css                                                                                 */const T={class:"smart-table-operate-block"},k={class:"smart-table-setting-block"},E={key:0},I={key:1},U={key:2,class:"smart-table-operate"},N={class:"smart-query-table-page"},C={__name:"file-list",setup(C){const q=n([{title:"主键ID",dataIndex:"fileId",ellipsis:!0,width:70},{title:"文件夹",dataIndex:"folderType",ellipsis:!0,width:100},{title:"文件名称",dataIndex:"fileName",width:200},{title:"文件大小",dataIndex:"fileSize",ellipsis:!0,width:100},{title:"文件类型",dataIndex:"fileType",ellipsis:!0,width:80},{title:"上传人",dataIndex:"creatorName",ellipsis:!0,width:100},{title:"人类型",dataIndex:"creatorUserType",ellipsis:!0,width:100},{title:"上传时间",dataIndex:"createTime",ellipsis:!0,width:150},{title:"操作",dataIndex:"action",width:120,fixed:"right"}]),F={folderType:void 0,fileName:void 0,fileKey:void 0,fileType:void 0,creatorName:void 0,createTime:[],createTimeBegin:void 0,createTimeEnd:void 0,pageNum:1,pageSize:10},M=u({...F}),O=n(!1),P=n([]),K=n(0);function B(){let e=M.pageSize;Object.assign(M,F),M.pageSize=e,D()}async function D(){O.value=!0;try{let e=await l.queryPage(M);for(const a of e.data.list)a.fileSize=R(a.fileSize);P.value=e.data.list,K.value=e.data.total}catch(e){i.captureError(e)}finally{O.value=!1}}function L(e,a){M.createTimeBegin=a[0],M.createTimeEnd=a[1]}function R(e){if(!e)return"";var a=1024;return e<a?e+"B":e<Math.pow(a,2)?(e/a).toFixed(2)+"KB":e<Math.pow(a,3)?(e/Math.pow(a,2)).toFixed(2)+"MB":e<Math.pow(a,4)?(e/Math.pow(a,3)).toFixed(2)+"G":(e/Math.pow(a,4)).toFixed(2)+"T"}const V=n();p(D);const Y=n(!1);function $(){Y.value=!0}function J(){Y.value=!1,D()}return(n,u)=>{const p=m("a-form-item"),C=m("a-input"),F=m("a-range-picker"),R=m("SearchOutlined"),A=m("a-button"),G=m("ReloadOutlined"),Q=m("a-button-group"),H=m("a-row"),W=m("a-form"),X=m("cloud-upload-outlined"),Z=m("a-table"),ee=m("a-pagination"),ae=m("a-modal"),te=m("a-card"),le=c("privilege");return y(),f(S,null,[v((y(),g(W,{class:"smart-query-form"},{default:j((()=>[h(H,{class:"smart-query-form-row"},{default:j((()=>[h(p,{label:"文件夹类型",class:"smart-query-form-item"},{default:j((()=>[h(o,{width:"150px",value:M.folderType,"onUpdate:value":u[0]||(u[0]=e=>M.folderType=e),enumName:"FILE_FOLDER_TYPE_ENUM",placeholder:"文件夹类型"},null,8,["value"])])),_:1}),h(p,{label:"文件名",class:"smart-query-form-item"},{default:j((()=>[h(C,{style:{width:"150px"},value:M.fileName,"onUpdate:value":u[1]||(u[1]=e=>M.fileName=e),placeholder:"文件名"},null,8,["value"])])),_:1}),h(p,{label:"文件Key",class:"smart-query-form-item"},{default:j((()=>[h(C,{style:{width:"150px"},value:M.fileKey,"onUpdate:value":u[2]||(u[2]=e=>M.fileKey=e),placeholder:"文件Key"},null,8,["value"])])),_:1}),h(p,{label:"文件类型",class:"smart-query-form-item"},{default:j((()=>[h(C,{style:{width:"150px"},value:M.fileType,"onUpdate:value":u[3]||(u[3]=e=>M.fileType=e),placeholder:"文件类型"},null,8,["value"])])),_:1}),h(p,{label:"创建人",class:"smart-query-form-item"},{default:j((()=>[h(C,{style:{width:"150px"},value:M.creatorName,"onUpdate:value":u[4]||(u[4]=e=>M.creatorName=e),placeholder:"创建人"},null,8,["value"])])),_:1}),h(p,{label:"创建时间",class:"smart-query-form-item"},{default:j((()=>[h(F,{value:M.createTime,"onUpdate:value":u[5]||(u[5]=e=>M.createTime=e),presets:_(s),style:{width:"220px"},onChange:L},null,8,["value","presets"])])),_:1}),h(p,{class:"smart-query-form-item"},{default:j((()=>[h(Q,null,{default:j((()=>[h(A,{type:"primary",onClick:D},{icon:j((()=>[h(R)])),default:j((()=>[b(" 查询 ")])),_:1}),h(A,{onClick:B},{icon:j((()=>[h(G)])),default:j((()=>[b(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})),[[le,"support:file:query"]]),h(te,{size:"small",bordered:!1,hoverable:!0},{default:j((()=>[h(H,{class:"smart-table-btn-block"},{default:j((()=>[w("div",T,[h(A,{type:"primary",onClick:$},{icon:j((()=>[h(X)])),default:j((()=>[b(" 上传文件 ")])),_:1})]),w("div",k,[h(r,{modelValue:q.value,"onUpdate:modelValue":u[6]||(u[6]=e=>q.value=e),tableId:null,refresh:D},null,8,["modelValue"])])])),_:1}),h(Z,{size:"small",scroll:{x:1300},dataSource:P.value,columns:q.value,rowKey:"fileId",bordered:"",loading:O.value,pagination:!1},{bodyCell:j((({text:e,record:a,column:t})=>["folderType"===t.dataIndex?(y(),f("span",E,z(n.$smartEnumPlugin.getDescByValue("FILE_FOLDER_TYPE_ENUM",e)),1)):x("",!0),"creatorUserType"===t.dataIndex?(y(),f("span",I,z(n.$smartEnumPlugin.getDescByValue("USER_TYPE_ENUM",e)),1)):x("",!0),"action"===t.dataIndex?(y(),f("div",U,[h(A,{onClick:e=>{return t=a,void V.value.showPreview(t);var t},type:"link"},{default:j((()=>[b("查看")])),_:2},1032,["onClick"]),h(A,{onClick:e=>async function(e){try{await l.downLoadFile(e.fileKey)}catch(a){i.captureError(a)}}(a),type:"link"},{default:j((()=>[b("下载")])),_:2},1032,["onClick"])])):x("",!0)])),_:1},8,["dataSource","columns","loading"]),w("div",N,[h(ee,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:_(e),defaultPageSize:M.pageSize,current:M.pageNum,"onUpdate:current":u[7]||(u[7]=e=>M.pageNum=e),pageSize:M.pageSize,"onUpdate:pageSize":u[8]||(u[8]=e=>M.pageSize=e),total:K.value,onChange:D,onShowSizeChange:D,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])]),h(d,{ref_key:"filePreviewModalRef",ref:V},null,512),h(ae,{open:Y.value,"onUpdate:open":u[9]||(u[9]=e=>Y.value=e),title:"上传文件",onOnCancel:J,onOk:J},{default:j((()=>[h(a,{"list-type":"text",maxUploadSize:5,buttonText:"点击上传文件",defaultFileList:[],multiple:!0,folder:_(t).COMMON.value},null,8,["folder"])])),_:1},8,["open"])])),_:1})],64)}}};export{C as default};
