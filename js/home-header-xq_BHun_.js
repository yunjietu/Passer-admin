import{_ as e,z as t,h as a}from"./index-ZxpkwSGJ.js";import{u as s}from"./ua-parser-js-BGt8dhPM.js";import{l as n}from"./lunar-javascript-C71wK1e4.js";import{_ as o}from"./lodash-DJa03WnC.js";import{at as i,au as l}from"./@ant-design-rHMPkvPq.js";import{b as r,M as p}from"./ant-design-vue-DFQN5xdf.js";import{m as d,r as u,b2 as c,b as m,o as g,c as f,bz as v,ai as x,J as h,u as y,be as b,ah as j,aY as w,aW as $,h as k}from"./@vue-wTDZSr7R.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./dayjs-CSPdbndm.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./vue-DiME50Ru.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./@ctrl-B1U3vBhl.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";const N=["梦想不会自动成真，奋斗是其桥梁；目标不会自动抵达，奔跑才有远方!","成长是一场和自己的比赛，不要担心别人会做得比你好，只要你每天都比前一天做得好!","最慢的步伐不是跬步，而是徘徊；最快的脚步不是冲刺，而是坚持!","平日里的千锤百炼，才能托举出光彩时刻；逆境中的亮剑、失败后的奋起，才能让梦想成真。哪有什么一战成名，其实都是百炼成钢。“天才”都是汗水浇灌出来的，天赋或许可以决定起点，但唯有坚持和努力才能达到终点。","历尽天华成此景，人间万事出艰辛。志不求易者成，事不避难者进!","每一个不向命运低头、努力生活的人，都值得被尊重。","青年的肩上，从不只有清风明月，更有责任担当。岁月因青春慨然以赴而更加美好，世间因少年挺身向前而更加瑰丽。请相信，不会有人永远年轻，但永远有人年轻。","人生路上，总有人走得比你快，但不必介意，也不必着急。一味羡慕别人的成绩，只会给自己平添压力、徒增烦恼。不盲从别人的脚步，坚定目标，才能找到自己的节奏，进而逢山开路、遇水搭桥。","没有理所当然的成功，也没有毫无道理的平庸。值得拥有的东西，永远都来之不易。所以在徘徊迷茫时，不要质疑你的付出，这些累积都会变成一种沉淀，默默为你铺路!"],I={class:"user-header"},L={class:"department-info",style:{color:"#666","margin-left":"20px"}},_={class:"balance-info",style:{color:"#1890ff","margin-left":"20px"}},C={class:"day-info",style:{color:"#333"}},D={class:"left-content"},z={class:"last-login-info"},U={class:"sentence",href:"#",target:"_blank"},M=(e=>(w("data-v-c860a97b"),e=e(),$(),e))((()=>x("div",{class:"weather"},[x("iframe",{width:"100%",scrolling:"no",height:"50",frameborder:"0",allowtransparency:"true",src:"//i.tianqi.com/index.php?c=code&id=12&icon=1&num=3&site=12"})],-1))),T=e({__name:"home-header",setup(e){const w=t(),$=d((()=>w.departmentName)),T=d((()=>{let e="",t=(new Date).getHours();return e=t>0&&t<=6?"午夜好，":t>6&&t<=11?"早上好，":t>11&&t<=14?"中午好，":t>14&&t<=18?"下午好，":"晚上好，",e+w.$state.actualName})),B=d((()=>{let e="";if(w.$state.lastLoginTime&&(e=e+"上次登录:"+w.$state.lastLoginTime),w.$state.lastLoginUserAgent){let t=s(w.$state.lastLoginUserAgent);e+="; 设备:",t.browser.name&&(e=e+" "+t.browser.name),t.os.name&&(e=e+" "+t.os.name);let a=t.device.vendor?t.device.vendor+t.device.model:null;a&&(e=e+" "+a+";")}return w.$state.lastLoginIpRegion&&(e=e+"; "+w.$state.lastLoginIpRegion),w.$state.lastLoginIp&&(e=e+"; "+w.$state.lastLoginIp),e})),F=d((()=>{let e=n.Solar.fromDate(new Date),t=e.toString(),a=e.getWeekInChinese(),s=n.Lunar.fromDate(new Date),o=s.getMonthInChinese(),i=s.getDayInChinese(),l=s.getPrevJieQi().getName(),r=s.getNextJieQi();return`${t} 星期${a}，农历${o}月${i}（当前${l}，${r.getName()+" "+r.getSolar().toYmd()} ）`})),S=d((()=>N[o.random(0,N.length-1)])),J=u("--"),W=w.employeeId;function A(){W&&a.getBalance(W).then((e=>{J.value=e.data?.balance??"--"}))}function O(){if(!W)return void r.error("未获取到当前用户ID");const e={employeeId:W,pageNum:1,pageSize:50};a.getBalanceLogs(e).then((e=>{const t=e.data?.list||[],a=Math.min(820,Math.round(.95*window.innerWidth));p.info({title:"余额明细",width:a,centered:!0,okText:"知道了",content:k("div",{style:"text-align:left; max-height: 60vh; overflow-y: auto;"},[k("div",{style:"display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;"},[k("div",{style:"font-weight:600;"},"当前余额："),k("div",{style:"font-size:16px;color:#1890ff;font-weight:600;"},`￥${Number(J.value??0).toFixed(2)}`)]),k("table",{class:"ant-table",style:"width:100%;margin-top:8px;border-collapse:collapse;font-size:12px;"},[k("thead",{},[k("tr",{},[k("th",{style:"padding:8px 12px;text-align:center;background:#fafafa;position:sticky;top:0;"},"时间"),k("th",{style:"padding:8px 12px;text-align:center;background:#fafafa;position:sticky;top:0;"},"类型"),k("th",{style:"padding:8px 12px;text-align:right;background:#fafafa;position:sticky;top:0;"},"变动金额"),k("th",{style:"padding:8px 12px;text-align:right;background:#fafafa;position:sticky;top:0;"},"变动后余额"),k("th",{style:"padding:8px 12px;text-align:left;background:#fafafa;position:sticky;top:0;"},"备注")])]),k("tbody",{},t.map(((e,t)=>{const a=Number(e.amount||0),s=Number(e.afterBalance||0);return k("tr",{style:`background:${t%2==1?"#fafafa":"#fff"};`},[k("td",{style:"padding:8px 12px;text-align:center;white-space:nowrap;"},e.createTime),k("td",{style:"padding:8px 12px;text-align:center;"},1===e.type?"充值":"消费"),k("td",{style:`padding:8px 12px;text-align:right;color:${a>=0?"#52c41a":"#cf1322"};font-weight:600;`},`${a>=0?"+":""}￥${Math.abs(a).toFixed(2)}`),k("td",{style:"padding:8px 12px;text-align:right;"},`￥${s.toFixed(2)}`),k("td",{style:"padding:8px 12px;text-align:left;max-width:260px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"},e.remark||"")])})))])])})}))}A();const Q=u(!1),R=u(""),Y=u(!1),q=u("");function E(){R.value="",Q.value=!0}async function H(){!R.value||isNaN(R.value)||Number(R.value)<=0?r.error("请输入有效金额"):(await a.recharge(W,R.value,"用户自助充值"),r.success("充值成功"),Q.value=!1,A())}async function P(){!q.value||isNaN(q.value)||Number(q.value)<=0?r.error("请输入有效金额"):(await a.consume(W,q.value,"用户自助消费"),r.success("消费成功"),Y.value=!1,A())}const G=w.administratorFlag;return(e,t)=>{const a=c("a-row"),s=c("a-page-header"),n=c("a-input"),o=c("a-modal");return g(),m("div",I,[f(s,{title:T.value},{subTitle:v((()=>[x("span",L,"所属部门："+b($.value),1),x("span",_,[h("余额：￥"+b(J.value)+" ",1),x("a",{onClick:O,style:{"margin-left":"8px"}},"明细"),y(G)?(g(),m("a",{key:0,onClick:E,style:{"margin-left":"8px"}},"充值")):j("",!0)])])),extra:v((()=>[x("p",C,b(F.value),1)])),default:v((()=>[f(a,{class:"content"},{default:v((()=>[x("span",D,[x("p",z,[f(y(i)),h(b(B.value),1)]),x("a",U,[f(y(l),{spin:""}),h(" "+b(S.value),1)])]),M])),_:1})])),_:1},8,["title"]),f(o,{open:Q.value,"onUpdate:open":t[1]||(t[1]=e=>Q.value=e),title:"充值",onOk:H,onCancel:t[2]||(t[2]=()=>{Q.value=!1})},{default:v((()=>[f(n,{value:R.value,"onUpdate:value":t[0]||(t[0]=e=>R.value=e),placeholder:"请输入充值金额",type:"number"},null,8,["value"])])),_:1},8,["open"]),f(o,{open:Y.value,"onUpdate:open":t[4]||(t[4]=e=>Y.value=e),title:"消费",onOk:P,onCancel:t[5]||(t[5]=()=>{Y.value=!1})},{default:v((()=>[f(n,{value:q.value,"onUpdate:value":t[3]||(t[3]=e=>q.value=e),placeholder:"请输入消费金额",type:"number"},null,8,["value"])])),_:1},8,["open"])])}}},[["__scopeId","data-v-c860a97b"]]);export{T as default};
