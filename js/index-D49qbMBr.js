import{d as e}from"./dayjs-CSPdbndm.js";import{_ as a,z as t,P as l,h as o}from"./index-ZxpkwSGJ.js";import{r,a as i,e as n,b2 as s,b as d,o as p,ai as u,c as m,be as c,bz as g,J as y,aY as v,aW as j}from"./@vue-wTDZSr7R.js";import"./@ant-design-rHMPkvPq.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./ant-design-vue-DFQN5xdf.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./lodash-DJa03WnC.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";const f={class:"balance-log-container"},w={class:"balance-log-header"},b=(e=>(v("data-v-4ed892c6"),e=e(),j(),e))((()=>u("h3",null,"余额明细",-1))),h=a({__name:"index",setup(a){const v=t().employeeId,j=r("--"),h=r(!1),k=r([]),_=i({type:void 0,keyword:"",dateRange:[]}),z=i({current:1,pageSize:10,total:0,showTotal:e=>`共 ${e} 条`,showSizeChanger:!0,pageSizeOptions:l}),x=[{title:"时间",dataIndex:"createTime",key:"createTime",align:"center"},{title:"类型",dataIndex:"type",key:"type",align:"center",customRender:({text:e})=>1===e?"充值":"消费"},{title:"变动金额",dataIndex:"amount",key:"amount",align:"center"},{title:"变动后余额",dataIndex:"afterBalance",key:"afterBalance",align:"center"},{title:"备注",dataIndex:"remark",key:"remark",align:"center"}],S=async()=>{h.value=!0;try{const a=(await o.getBalanceLogs((()=>{const a={employeeId:v,pageNum:z.current,pageSize:z.pageSize,type:_.type,keyword:_.keyword?.trim()||void 0};return 2===_.dateRange?.length&&(a.startTime=e(_.dateRange[0]).format("YYYY-MM-DD HH:mm:ss"),a.endTime=e(_.dateRange[1]).format("YYYY-MM-DD HH:mm:ss")),a})())).data||{};k.value=a.list||[],z.current=a.pageNum||1,z.pageSize=a.pageSize||z.pageSize,z.total=a.total||0}finally{h.value=!1}},Y=()=>{z.current=1,S()},I=()=>{_.type=void 0,_.keyword="",_.dateRange=[],z.current=1,z.pageSize=10,S()},R=e=>{z.current=e.current,z.pageSize=e.pageSize,S()};return n((async()=>{await(async()=>{const e=await o.getBalance(v);j.value=e.data?.balance??"--"})(),await S()})),(e,a)=>{const t=s("a-select-option"),l=s("a-select"),o=s("a-form-item"),r=s("a-range-picker"),i=s("a-input"),n=s("a-button"),v=s("a-space"),S=s("a-form"),C=s("a-table");return p(),d("div",f,[u("div",w,[b,u("div",null,"当前余额：￥"+c(j.value),1)]),m(S,{layout:"inline",class:"balance-log-filter"},{default:g((()=>[m(o,{label:"类型"},{default:g((()=>[m(l,{value:_.type,"onUpdate:value":a[0]||(a[0]=e=>_.type=e),allowClear:"",placeholder:"全部",style:{width:"120px"}},{default:g((()=>[m(t,{value:1},{default:g((()=>[y("充值")])),_:1}),m(t,{value:2},{default:g((()=>[y("消费")])),_:1})])),_:1},8,["value"])])),_:1}),m(o,{label:"时间范围"},{default:g((()=>[m(r,{value:_.dateRange,"onUpdate:value":a[1]||(a[1]=e=>_.dateRange=e),"show-time":"",style:{width:"240px"}},null,8,["value"])])),_:1}),m(o,{label:"备注关键字"},{default:g((()=>[m(i,{value:_.keyword,"onUpdate:value":a[2]||(a[2]=e=>_.keyword=e),placeholder:"输入备注关键字",allowClear:"",style:{width:"200px"}},null,8,["value"])])),_:1}),m(o,null,{default:g((()=>[m(v,null,{default:g((()=>[m(n,{type:"primary",onClick:Y},{default:g((()=>[y("查询")])),_:1}),m(n,{onClick:I},{default:g((()=>[y("重置")])),_:1})])),_:1})])),_:1})])),_:1}),m(C,{columns:x,dataSource:k.value,loading:h.value,pagination:z,rowKey:"id",bordered:"",onChange:R},null,8,["dataSource","loading","pagination"])])}}},[["__scopeId","data-v-4ed892c6"]]);export{h as default};
