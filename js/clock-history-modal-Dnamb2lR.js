import{h as a}from"./hrkzy-account-api-DYH7tamM.js";import{_ as e,s as t}from"./index-ZxpkwSGJ.js";import{d as o}from"./dayjs-CSPdbndm.js";import{b as s}from"./ant-design-vue-DFQN5xdf.js";import{r as i,a as r,b2 as l,ag as n,o as c,bz as u,ai as p,c as d,b as m,ah as g,J as j,be as v}from"./@vue-wTDZSr7R.js";import"./@ant-design-rHMPkvPq.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./lodash-DJa03WnC.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";const f={style:{"font-size":"12px",color:"#666"}},y={class:"table-container"},h={key:1},S={class:"text-ellipsis",style:{"max-width":"300px",display:"inline-block"}},z=e({__name:"clock-history-modal",setup(e,{expose:z}){const x=i(!1),b=i(!1),w=i([]),I=i(""),k=i(""),C=r({accountId:null,account:"",pageNum:1,pageSize:10}),_=r({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:a=>`共 ${a} 条记录`}),N=[{title:"打卡时间",dataIndex:"clockTime",width:180,align:"center"},{title:"结果",dataIndex:"result",width:100,align:"center"},{title:"结果详情",dataIndex:"resultDetail",width:300,align:"left",ellipsis:!0}];function D(){x.value=!1}function E(a){C.pageNum=a.current,C.pageSize=a.pageSize,_.current=a.current,_.pageSize=a.pageSize,Y()}async function Y(){try{b.value=!0;const e={accountId:C.accountId,account:C.account,pageNum:C.pageNum,pageSize:C.pageSize},t=await a.clockRecordPage(e);t&&t.data?(w.value=t.data.list||[],_.total=t.data.total||0,_.current=t.data.pageNum||C.pageNum,_.pageSize=t.data.pageSize||C.pageSize):(w.value=[],_.total=0)}catch(e){s.error("加载打卡历史失败"),t.captureError(e),w.value=[],_.total=0}finally{b.value=!1}}return z({showModal:function(a){C.accountId=a.id,C.account=a.account,I.value=a.name||"未知用户",k.value=a.account||"未知账号",x.value=!0,C.pageNum=1,_.current=1,Y()}}),(a,e)=>{const t=l("a-tag"),s=l("a-tooltip"),i=l("a-table"),r=l("a-modal");return c(),n(r,{open:x.value,width:1e3,forceRender:"",footer:null,onCancel:D},{title:u((()=>[p("div",null,[j(" 打卡历史 "),p("span",f,v(I.value)+" - "+v(k.value),1)])])),default:u((()=>[p("div",y,[d(i,{dataSource:w.value,columns:N,pagination:_,loading:b.value,rowKey:"id",size:"small",bordered:"",scroll:{x:600},onChange:E},{bodyCell:u((({column:a,record:e,text:i})=>{return["result"===a.dataIndex?(c(),n(t,{key:0,color:"SUCCESS"===e.result?"success":"error"},{default:u((()=>[j(v("SUCCESS"===e.result?"成功":"失败"),1)])),_:2},1032,["color"])):"clockTime"===a.dataIndex?(c(),m("span",h,v((r=i,r?o(r).format("YYYY-MM-DD HH:mm:ss"):"")),1)):"resultDetail"===a.dataIndex?(c(),n(s,{key:2,title:i,placement:"topLeft"},{default:u((()=>[p("span",S,v(i),1)])),_:2},1032,["title"])):g("",!0)];var r})),_:1},8,["dataSource","pagination","loading"])])])),_:1},8,["open"])}}},[["__scopeId","data-v-f8635983"]]);export{z as default};
