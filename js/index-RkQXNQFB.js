import{_ as a}from"./lodash-DJa03WnC.js";import{r as e}from"./role-api-w0pDqSQW.js";import{_ as t,s}from"./index-ZxpkwSGJ.js";import{b as o}from"./ant-design-vue-DFQN5xdf.js";import{i,r as p,w as l,e as r,b2 as d,z as u,b as c,o as n,ai as m,c as v,y,ag as j,bz as f,J as b,F as T,b0 as w,be as g,u as _}from"./@vue-wTDZSr7R.js";import"./@ant-design-rHMPkvPq.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./dayjs-CSPdbndm.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";const S={class:"btn-group"},h={class:"data-container"},x=t({__name:"index",props:{value:Number},emits:["update:value"],setup(t){let x=i("selectRoleId"),D=p([]),I=p([]);async function k(){let a=await e.getDataScopeList();D.value=a.data,I.value=[],D.value.forEach((a=>{I.value.push({viewType:void 0,dataScopeType:a.dataScopeType})})),z()}async function z(){let a=(await e.getDataScopeByRoleId(x.value)).data;I.value=[],D.value.forEach((e=>{let t=a.find((a=>a.dataScopeType==e.dataScopeType));I.value.push({viewType:t?t.viewType:void 0,dataScopeType:e.dataScopeType})}))}async function E(){try{let t={roleId:x.value,dataScopeItemList:I.value.filter((e=>!a.isUndefined(e.viewType)))};await e.updateDataScope(t),o.success("保存成功"),k()}catch(t){s.captureError(t)}}return l((()=>x.value),(()=>z())),r(k),(a,e)=>{const t=d("a-button"),s=d("a-col"),o=d("a-row"),i=d("a-radio"),p=d("a-radio-group"),l=u("privilege");return n(),c("div",null,[m("div",S,[y((n(),j(t,{class:"button-style",type:"primary",onClick:E},{default:f((()=>[b(" 保存 ")])),_:1})),[[l,"system:role:dataScope:update"]]),v(t,{class:"button-style",onClick:k},{default:f((()=>[b(" 刷新 ")])),_:1})]),v(o,{class:"header"},{default:f((()=>[v(s,{class:"tab-margin",span:4},{default:f((()=>[b("业务单据")])),_:1}),v(s,{class:"tab-data",span:8},{default:f((()=>[b("查看数据范围")])),_:1}),v(s,{class:"tab-margin",span:12})])),_:1}),m("div",h,[(n(!0),c(T,null,w(_(D),((a,e)=>(n(),j(o,{class:"data",align:"middle",justify:"center",key:a.dataScopeType},{default:f((()=>[v(s,{class:"tab-margin",span:4},{default:f((()=>[b(g(a.dataScopeTypeName),1)])),_:2},1024),v(s,{class:"tab-data",span:8},{default:f((()=>[v(p,{value:_(I)[e].viewType,"onUpdate:value":a=>_(I)[e].viewType=a},{default:f((()=>[(n(!0),c(T,null,w(a.viewTypeList,(e=>(n(),j(i,{key:`${a.dataScopeType}-${e.viewType}`,class:"radio-style",value:e.viewType},{default:f((()=>[b(g(e.viewTypeName),1)])),_:2},1032,["value"])))),128))])),_:2},1032,["value","onUpdate:value"])])),_:2},1024),v(s,{class:"tab-margin tab-desc",span:12},{default:f((()=>[m("p",null,g(a.dataScopeTypeDesc),1)])),_:2},1024)])),_:2},1024)))),128))])])}}},[["__scopeId","data-v-b84c8b4d"]]);export{x as default};
