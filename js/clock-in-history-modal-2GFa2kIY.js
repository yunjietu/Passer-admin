import{c as a}from"./chaoxing-account-api-LV_gIdy7.js";import{_ as e,s as t}from"./index-ZxpkwSGJ.js";import{d as o}from"./dayjs-CSPdbndm.js";import{b as s}from"./ant-design-vue-DFQN5xdf.js";import{r,a as i,b2 as l,ag as n,o as u,bz as c,ai as p,c as m,b as d,ah as g,J as j,be as v}from"./@vue-wTDZSr7R.js";import"./@ant-design-rHMPkvPq.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./lodash-DJa03WnC.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";const y={style:{"font-size":"12px",color:"#666"}},f={class:"table-container"},h={key:1},S={class:"text-ellipsis",style:{"max-width":"200px",display:"inline-block"}},x=e({__name:"clock-in-history-modal",setup(e,{expose:x}){const z=r(!1),b=r(!1),w=r([]),I=r(""),k=r(""),C=i({account:"",course:"",pageNum:1,pageSize:10}),_=i({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:a=>`共 ${a} 条记录`}),N=[{title:"时间",dataIndex:"clockInTime",width:180,align:"center"},{title:"结果",dataIndex:"result",width:100,align:"center"},{title:"信息",dataIndex:"message",width:400,align:"left"}];function A(){z.value=!1}function E(a){C.pageNum=a.current,C.pageSize=a.pageSize,Y()}async function Y(){try{b.value=!0;const e={account:C.account,course:C.course,pageNum:C.pageNum,pageSize:C.pageSize},t=await a.clockInHistoryPage(e);t&&t.data?t.data.list&&Array.isArray(t.data.list)?(w.value=t.data.list,_.total=t.data.total||0,_.current=t.data.pageNum||C.pageNum,_.pageSize=t.data.pageSize||C.pageSize):Array.isArray(t.data)?(w.value=t.data,_.total=t.data.length,_.current=C.pageNum,_.pageSize=C.pageSize):(w.value=[],_.total=0):(w.value=[],_.total=0)}catch(e){s.error("加载打卡历史失败"),t.captureError(e),w.value=[],_.total=0}finally{b.value=!1}}return x({showModal:function(a){C.account=a.account,C.course=a.course,I.value=a.name||"未知用户",k.value=a.account||"未知账号",z.value=!0,Y()}}),(a,e)=>{const t=l("a-tag"),s=l("a-tooltip"),r=l("a-table"),i=l("a-modal");return u(),n(i,{open:z.value,width:1e3,forceRender:"",footer:null,onCancel:A},{title:c((()=>[p("div",null,[j(" 打卡历史 "),p("span",y,v(I.value)+" - "+v(k.value),1)])])),default:c((()=>[p("div",f,[m(r,{dataSource:w.value,columns:N,pagination:_,loading:b.value,rowKey:"id",size:"small",bordered:"",scroll:{x:800},onChange:E},{bodyCell:c((({column:a,record:e,text:r})=>{return["result"===a.dataIndex?(u(),n(t,{key:0,color:"SUCCESS"===e.result?"success":"error"},{default:c((()=>[j(v("SUCCESS"===e.result?"成功":e.result),1)])),_:2},1032,["color"])):"clockInTime"===a.dataIndex?(u(),d("span",h,v((i=r,i?o(i).format("YYYY-MM-DD HH:mm"):"")),1)):"message"===a.dataIndex?(u(),n(s,{key:2,title:r,placement:"topLeft"},{default:c((()=>[p("span",S,v(r),1)])),_:2},1032,["title"])):g("",!0)];var i})),_:1},8,["dataSource","pagination","loading"])])])),_:1},8,["open"])}}},[["__scopeId","data-v-e26da8e3"]]);export{x as default};
