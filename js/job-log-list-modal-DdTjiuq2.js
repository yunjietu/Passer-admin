import{j as e}from"./job-api-BuFufgo2.js";import{P as a,s as t}from"./index-ZxpkwSGJ.js";import{_ as l}from"./index-wy53HiSK.js";import{T as s}from"./table-id-const-CfofKxZg.js";import{r as i,a as o,b2 as r,ag as u,o as d,bz as n,c as m,J as p,K as c,u as g,ai as f,b as j,ah as v,F as h,be as y}from"./@vue-wTDZSr7R.js";import"./ant-design-vue-DFQN5xdf.js";import"./@babel-rSvM8Ko2.js";import"./@ant-design-rHMPkvPq.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./dayjs-CSPdbndm.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./lodash-DJa03WnC.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./sortablejs-CRp0PNdb.js";/* empty css                                                                                 */const b={style:{"margin-top":"5px"}},x={key:0,style:{color:"#39c710"}},_={key:1,style:{color:"#f50"}},w={class:"smart-query-table-page"},S={__name:"job-log-list-modal",setup(S,{expose:z}){const I=i(!1),T=i("");z({show:function(e,a){O.jobId=e,E(),I.value=!0,T.value=a}});const k=i([{title:"执行人",dataIndex:"createName",width:100,ellipsis:!0},{title:"执行参数",dataIndex:"param",width:80,ellipsis:!0},{title:"执行时间",dataIndex:"executeStartTime",width:200},{title:"执行用时",dataIndex:"executeTimeMillis",width:100,ellipsis:!0},{title:"结果",dataIndex:"successFlag",width:80},{title:"执行结果",dataIndex:"executeResult",ellipsis:!0,width:250},{title:"ip",dataIndex:"ip",width:110},{title:"进程id",dataIndex:"processId",width:60},{title:"程序目录",dataIndex:"programPath",ellipsis:!0}]),C={searchWord:"",jobId:null,successFlag:null,endTime:null,startTime:null,pageNum:1,pageSize:10},O=o({...C}),q=i(!1),U=i([]),F=i(0);let P=i();function N(e,a){O.startTime=a[0],O.endTime=a[1]}function J(){Object.assign(O,C),E()}function W(){O.pageNum=1,E()}async function E(){try{q.value=!0;let a=await e.queryJobLog(O);const t=a.data.list;F.value=a.data.total,U.value=t}catch(a){t.captureError(a)}finally{q.value=!1}}return(e,t)=>{const i=r("a-input"),o=r("a-form-item"),S=r("a-select-option"),z=r("a-select"),C=r("a-range-picker"),L=r("a-space"),M=r("SearchOutlined"),R=r("a-button"),V=r("ReloadOutlined"),K=r("a-button-group"),A=r("a-row"),B=r("a-form"),D=r("a-tag"),G=r("CheckOutlined"),Q=r("WarningOutlined"),$=r("a-table"),H=r("a-pagination"),X=r("a-card"),Y=r("a-drawer");return d(),u(Y,{open:I.value,"onUpdate:open":t[6]||(t[6]=e=>I.value=e),width:1e3,title:T.value,placement:"right",destroyOnClose:!0},{default:n((()=>[m(B,{class:"smart-query-form"},{default:n((()=>[m(A,{class:"smart-query-form-row"},{default:n((()=>[m(o,{label:"关键字",class:"smart-query-form-item"},{default:n((()=>[m(i,{style:{width:"200px"},value:O.searchWord,"onUpdate:value":t[0]||(t[0]=e=>O.searchWord=e),placeholder:"请输入关键字",maxlength:30},null,8,["value"])])),_:1}),m(o,{label:"执行结果",class:"smart-query-form-item"},{default:n((()=>[m(z,{style:{width:"100px"},value:O.successFlag,"onUpdate:value":t[1]||(t[1]=e=>O.successFlag=e),placeholder:"请选择",allowClear:""},{default:n((()=>[(d(),u(S,{key:1},{default:n((()=>[p(" 成功 ")])),_:1})),(d(),u(S,{key:0},{default:n((()=>[p(" 失败 ")])),_:1}))])),_:1},8,["value"])])),_:1}),m(o,{label:"执行时间",class:"smart-query-form-item"},{default:n((()=>[m(L,{direction:"vertical",size:12},{default:n((()=>[m(C,{value:g(P),"onUpdate:value":t[2]||(t[2]=e=>c(P)?P.value=e:P=e),style:{width:"220px"},onChange:N},null,8,["value"])])),_:1})])),_:1}),m(o,{class:"smart-query-form-item smart-margin-left10"},{default:n((()=>[m(K,null,{default:n((()=>[m(R,{type:"primary",onClick:W},{icon:n((()=>[m(M)])),default:n((()=>[p(" 查询 ")])),_:1}),m(R,{onClick:J},{icon:n((()=>[m(V)])),default:n((()=>[p(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),m(X,{size:"small",bordered:!1,hoverable:!0},{default:n((()=>[m(A,{justify:"end"},{default:n((()=>[m(l,{class:"smart-margin-bottom5",modelValue:k.value,"onUpdate:modelValue":t[3]||(t[3]=e=>k.value=e),tableId:g(s).SUPPORT.JOB_LOG,refresh:E},null,8,["modelValue","tableId"])])),_:1}),m($,{size:"small",loading:q.value,bordered:"",dataSource:U.value,columns:k.value,rowKey:"jobLogId",pagination:!1,scroll:{x:1300}},{bodyCell:n((({record:e,column:a})=>["executeStartTime"===a.dataIndex?(d(),j(h,{key:0},[f("div",null,[m(D,{color:"green"},{default:n((()=>[p("始")])),_:1}),p(y(e.executeStartTime),1)]),f("div",b,[m(D,{color:"blue"},{default:n((()=>[p("终")])),_:1}),p(y(e.executeEndTime),1)])],64)):v("",!0),"executeTimeMillis"===a.dataIndex?(d(),j(h,{key:1},[p(y(e.executeTimeMillis)+" ms ",1)],64)):v("",!0),"successFlag"===a.dataIndex?(d(),j(h,{key:2},[e.successFlag?(d(),j("div",x,[m(G),p("成功")])):(d(),j("div",_,[m(Q),p("失败")]))],64)):v("",!0)])),_:1},8,["loading","dataSource","columns"]),f("div",w,[m(H,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:g(a),defaultPageSize:O.pageSize,current:O.pageNum,"onUpdate:current":t[4]||(t[4]=e=>O.pageNum=e),pageSize:O.pageSize,"onUpdate:pageSize":t[5]||(t[5]=e=>O.pageSize=e),total:F.value,onChange:E,onShowSizeChange:E,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])])])),_:1})])),_:1},8,["open","title"])}}};export{S as default};
