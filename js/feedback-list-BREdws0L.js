import{_ as e,c as a,j as t,s as l,P as s}from"./index-ZxpkwSGJ.js";import{d as i}from"./default-time-ranges-uUNYRUiy.js";import{_ as r}from"./index-CAEs7VG8.js";import o from"./feedback-detail-modal-CAuzTBIL.js";import{b as d,M as n}from"./ant-design-vue-DFQN5xdf.js";import{a as u,r as c,e as p,b2 as m,z as f,b as g,o as y,c as h,bz as v,u as b,J as j,y as k,ag as x,ai as w,ah as _,be as I,F as z}from"./@vue-wTDZSr7R.js";import"./@ant-design-rHMPkvPq.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./lodash-DJa03WnC.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./dayjs-CSPdbndm.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";const S=["title"],C={key:2},q={key:4,class:"smart-table-operate"},D={class:"smart-query-table-page"},F=e({__name:"feedback-list",setup(e){const F=u([{title:"编号",dataIndex:"feedbackId",width:80,align:"center"},{title:"反馈内容",dataIndex:"feedbackContent",width:300,ellipsis:!0},{title:"反馈图片",dataIndex:"feedbackAttachment",width:120,align:"center"},{title:"联系方式",dataIndex:"contactInfo",width:120,ellipsis:!0},{title:"反馈人",dataIndex:"userName",width:100},{title:"反馈人类型",dataIndex:"userType",width:100},{title:"已读状态",dataIndex:"readFlag",width:100},{title:"已读时间",dataIndex:"readTime",width:150},{title:"反馈时间",dataIndex:"createTime",width:150},{title:"操作",dataIndex:"operation",width:100}]),T={startDate:void 0,endDate:void 0,searchWord:void 0,readFlag:void 0,pageNum:1,pageSize:a},U=u({...T}),E=c(!1),M=c([]),N=c(0);async function O(){try{E.value=!0;const e=await t.queryFeedback(U);M.value=e.data.list,N.value=e.data.total}catch(e){l.captureError(e)}finally{E.value=!1}}p((()=>{O()}));const P=c([]);function Y(e,a){U.startDate=a[0],U.endDate=a[1]}function R(){U.pageNum=1,O()}function W(){Object.assign(U,T),P.value=[],O()}const A=c();return(e,a)=>{const l=m("a-input"),u=m("a-form-item"),c=m("a-range-picker"),p=m("a-select-option"),T=m("a-select"),J=m("SearchOutlined"),L=m("a-button"),$=m("ReloadOutlined"),B=m("a-button-group"),K=m("a-row"),Q=m("a-form"),V=m("a-tag"),G=m("a-table"),H=m("a-pagination"),X=m("a-card"),Z=f("privilege");return y(),g(z,null,[h(Q,{class:"smart-query-form"},{default:v((()=>[h(K,{class:"smart-query-form-row"},{default:v((()=>[h(u,{label:"关键字",class:"smart-query-form-item",style:{"margin-right":"20px"}},{default:v((()=>[h(l,{style:{width:"240px"},value:U.searchWord,"onUpdate:value":a[0]||(a[0]=e=>U.searchWord=e),valueModifiers:{trim:!0},placeholder:"反馈内容/创建人"},null,8,["value"])])),_:1}),h(u,{label:"创建日期",class:"smart-query-form-item",style:{"margin-right":"20px"}},{default:v((()=>[h(c,{value:P.value,"onUpdate:value":a[1]||(a[1]=e=>P.value=e),onChange:Y,presets:b(i),format:"YYYY-MM-DD",style:{width:"240px"}},null,8,["value","presets"])])),_:1}),h(u,{label:"是否已读",class:"smart-query-form-item",style:{"margin-right":"20px"}},{default:v((()=>[h(T,{value:U.readFlag,"onUpdate:value":a[2]||(a[2]=e=>U.readFlag=e),placeholder:"请选择已读状态",style:{width:"120px"},allowClear:""},{default:v((()=>[h(p,{value:null},{default:v((()=>[j("全部")])),_:1}),h(p,{value:!1},{default:v((()=>[j("未读")])),_:1}),h(p,{value:!0},{default:v((()=>[j("已读")])),_:1})])),_:1},8,["value"])])),_:1}),h(u,{class:"smart-query-form-item"},{default:v((()=>[k((y(),x(B,null,{default:v((()=>[h(L,{type:"primary",onClick:R},{icon:v((()=>[h(J)])),default:v((()=>[j(" 查询 ")])),_:1}),h(L,{onClick:W},{icon:v((()=>[h($)])),default:v((()=>[j(" 重置 ")])),_:1})])),_:1})),[[Z,"feedback:query"]])])),_:1})])),_:1})])),_:1}),h(X,{size:"small"},{default:v((()=>[h(G,{rowKey:"feedbackId",dataSource:M.value,columns:F,pagination:!1,loading:E.value,size:"small",bordered:"",scroll:{x:1200},class:"feedback-table"},{bodyCell:v((({text:a,column:l,record:s})=>["feedbackContent"===l.dataIndex?(y(),g("div",{key:0,class:"feedback-content-cell",title:a},I(a),9,S)):_("",!0),"feedbackAttachment"===l.dataIndex?(y(),x(r,{key:1,fileList:a,type:"picture"},null,8,["fileList"])):_("",!0),"userType"===l.dataIndex?(y(),g("span",C,I(e.$smartEnumPlugin.getDescByValue("USER_TYPE_ENUM",a)),1)):_("",!0),"readFlag"===l.dataIndex?(y(),x(V,{key:3,color:a?"green":"red"},{default:v((()=>[j(I(a?"已读":"未读"),1)])),_:2},1032,["color"])):_("",!0),"operation"===l.dataIndex?(y(),g("div",q,[h(L,{onClick:e=>function(e){A.value.show(e)}(s),type:"link",size:"small"},{default:v((()=>[j("查看")])),_:2},1032,["onClick"]),k((y(),x(L,{type:"link",danger:"",size:"small",onClick:e=>function(e){e&&e.feedbackId?n.confirm({title:"删除确认",content:"确定要删除这条反馈吗？删除后无法恢复。",okText:"确定",cancelText:"取消",onOk:async()=>{try{await t.deleteFeedback(e.feedbackId),d.success("删除成功"),O()}catch(a){d.error("删除失败，请稍后重试")}}}):d.error("反馈ID不存在，无法删除")}(s)},{default:v((()=>[j(" 删除 ")])),_:2},1032,["onClick"])),[[Z,"feedback:delete"]])])):_("",!0)])),_:1},8,["dataSource","columns","loading"]),w("div",D,[h(H,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:b(s),defaultPageSize:U.pageSize,current:U.pageNum,"onUpdate:current":a[3]||(a[3]=e=>U.pageNum=e),pageSize:U.pageSize,"onUpdate:pageSize":a[4]||(a[4]=e=>U.pageSize=e),total:N.value,onChange:O,onShowSizeChange:O,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])])])),_:1}),h(o,{ref_key:"detailModalRef",ref:A,onRefresh:O},null,512)],64)}}},[["__scopeId","data-v-0664faeb"]]);export{F as default};
