import{L as e,P as a,s as t}from"./index-ZxpkwSGJ.js";import{d as s}from"./default-time-ranges-uUNYRUiy.js";import{u as l}from"./ua-parser-js-BGt8dhPM.js";import{c as o,l as r}from"./table-auto-height-D_FqPv5Z.js";import{_ as i}from"./index-wy53HiSK.js";import{T as n}from"./table-id-const-CfofKxZg.js";import{r as u,a as d,e as m,l as p,b2 as c,z as g,b as f,o as v,y,c as j,ag as b,bz as _,u as h,J as I,ai as w,ah as x,F as S,be as z}from"./@vue-wTDZSr7R.js";import"./ant-design-vue-DFQN5xdf.js";import"./@babel-rSvM8Ko2.js";import"./@ant-design-rHMPkvPq.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./dayjs-CSPdbndm.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./lodash-DJa03WnC.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./sortablejs-CRp0PNdb.js";/* empty css                                                                                 */const k={key:1},N={key:2},O={class:"smart-query-table-page"},L={__name:"login-log-list",setup(L){const P=u([{title:"用户ID",dataIndex:"userId",width:70},{title:"用户名",dataIndex:"userName",ellipsis:!0},{title:"类型",dataIndex:"userType",width:50,ellipsis:!0},{title:"IP",dataIndex:"loginIp",ellipsis:!0},{title:"IP地区",dataIndex:"loginIpRegion",ellipsis:!0},{title:"设备信息",dataIndex:"userAgent",ellipsis:!0},{title:"结果",dataIndex:"loginResult",ellipsis:!0},{title:"备注",dataIndex:"remark",ellipsis:!0},{title:"时间",dataIndex:"createTime",width:150}]),U={userName:"",ip:"",startDate:void 0,endDate:void 0,pageNum:1,pageSize:10},q=d({...U}),C=u([]),E=s;function D(e,a){q.startDate=a[0],q.endDate=a[1]}const R=u(!1),T=u([]),A=u(0);function G(){Object.assign(q,U),C.value=[],F()}function V(){q.pageNum=1,F()}async function F(){try{R.value=!0;let e=await r.queryList(q);for(const t of e.data.list){if(!t.userAgent)continue;let e=l(t.userAgent);t.browser=e.browser.name,t.os=e.os.name,t.device=e.device.vendor?e.device.vendor+e.device.model:""}const a=e.data.list;A.value=e.data.total,T.value=a}catch(e){t.captureError(e)}finally{R.value=!1}}const B=u(100),J=u(),$=u();function K(){o(B,[J,$],10)}return window.addEventListener("resize",K),m((()=>{F(),K()})),p((()=>{window.removeEventListener("resize",K)})),(t,s)=>{const l=c("a-input"),o=c("a-form-item"),r=c("a-range-picker"),u=c("SearchOutlined"),d=c("a-button"),m=c("ReloadOutlined"),p=c("a-button-group"),L=c("a-row"),U=c("a-form"),K=c("a-tag"),M=c("a-table"),Q=c("a-pagination"),Y=c("a-card"),H=g("privilege");return v(),f(S,null,[y((v(),b(U,{class:"smart-query-form",ref_key:"queryFormRef",ref:$},{default:_((()=>[j(L,{class:"smart-query-form-row"},{default:_((()=>[j(o,{label:"用户名称",class:"smart-query-form-item"},{default:_((()=>[j(l,{style:{width:"300px"},value:q.userName,"onUpdate:value":s[0]||(s[0]=e=>q.userName=e),placeholder:"用户名称"},null,8,["value"])])),_:1}),j(o,{label:"用户IP",class:"smart-query-form-item"},{default:_((()=>[j(l,{style:{width:"120px"},value:q.ip,"onUpdate:value":s[1]||(s[1]=e=>q.ip=e),placeholder:"IP"},null,8,["value"])])),_:1}),j(o,{label:"时间",class:"smart-query-form-item"},{default:_((()=>[j(r,{onChange:D,value:C.value,"onUpdate:value":s[2]||(s[2]=e=>C.value=e),presets:h(E),style:{width:"240px"}},null,8,["value","presets"])])),_:1}),j(o,{class:"smart-query-form-item smart-margin-left10"},{default:_((()=>[j(p,null,{default:_((()=>[j(d,{type:"primary",onClick:V},{icon:_((()=>[j(u)])),default:_((()=>[I(" 查询 ")])),_:1}),j(d,{onClick:G},{icon:_((()=>[j(m)])),default:_((()=>[I(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})),[[H,"support:loginLog:query"]]),j(Y,{size:"small",bordered:!1,hoverable:!0},{default:_((()=>[j(L,{justify:"end",ref_key:"tableOperatorRef",ref:J},{default:_((()=>[j(i,{class:"smart-margin-bottom5",modelValue:P.value,"onUpdate:modelValue":s[3]||(s[3]=e=>P.value=e),tableId:h(n).SUPPORT.LOGIN_LOG,refresh:F},null,8,["modelValue","tableId"])])),_:1},512),j(M,{size:"small",dataSource:T.value,columns:P.value,bordered:"",rowKey:"loginLogId",pagination:!1,loading:R.value,scroll:{y:B.value}},{bodyCell:_((({text:a,record:s,column:l})=>["loginResult"===l.dataIndex?(v(),f(S,{key:0},[a===h(e).LOGIN_SUCCESS.value?(v(),b(K,{key:0,color:"success"},{default:_((()=>[I("登录成功")])),_:1})):x("",!0),a===h(e).LOGIN_FAIL.value?(v(),b(K,{key:1,color:"error"},{default:_((()=>[I("登录失败")])),_:1})):x("",!0),a===h(e).LOGIN_OUT.value?(v(),b(K,{key:2,color:"processing"},{default:_((()=>[I("退出登录")])),_:1})):x("",!0)],64)):x("",!0),"userAgent"===l.dataIndex?(v(),f("div",k,z(s.browser)+" / "+z(s.os)+" / "+z(s.device),1)):x("",!0),"userType"===l.dataIndex?(v(),f("span",N,z(t.$smartEnumPlugin.getDescByValue("USER_TYPE_ENUM",a)),1)):x("",!0)])),_:1},8,["dataSource","columns","loading","scroll"]),w("div",O,[j(Q,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:h(a),defaultPageSize:q.pageSize,current:q.pageNum,"onUpdate:current":s[4]||(s[4]=e=>q.pageNum=e),pageSize:q.pageSize,"onUpdate:pageSize":s[5]||(s[5]=e=>q.pageSize=e),total:A.value,onChange:F,onShowSizeChange:F,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])])])),_:1})],64)}}};export{L as default};
