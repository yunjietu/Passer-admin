import{_ as e}from"./lodash-DJa03WnC.js";import{r as a}from"./role-api-w0pDqSQW.js";import{_ as t,c as o,s as l,d as s,P as i,S as r}from"./index-ZxpkwSGJ.js";import{_ as n}from"./index-0_dkeot7.js";import{M as d,b as p}from"./ant-design-vue-DFQN5xdf.js";import{i as c,w as u,e as m,a as y,r as g,m as v,b2 as j,z as f,b as h,o as w,ai as b,c as k,J as x,ag as I,ah as z,u as S,bz as E,y as C,be as _}from"./@vue-wTDZSr7R.js";import"./@ant-design-rHMPkvPq.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./dayjs-CSPdbndm.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./vue-router-BJIyZwNj.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./index-YdqzJmk0.js";import"./department-api-BBQ_I4Vj.js";const N={class:"header"},R={key:1},T=["onClick"],D={class:"smart-query-table-page"},M=t({__name:"index",setup(t){let M=c("selectRoleId");u((()=>M.value),(()=>J())),m(J);const O=y({...{pageNum:1,pageSize:o,roleId:void 0,keywords:void 0}}),P=g(0),U=g([]),q=g(!1);function A(){O.keywords="",J()}function F(){O.pageNum=1,J()}async function J(){try{q.value=!0,O.roleId=M.value;let e=await a.queryRoleEmployee(O);U.value=e.data.list,P.value=e.data.total}catch(e){l.captureError(e)}finally{q.value=!1}}const K=y([{title:"姓名",dataIndex:"actualName"},{title:"手机号",dataIndex:"phone"},{title:"登录账号",dataIndex:"loginName"},{title:"部门",dataIndex:"departmentName"},{title:"状态",dataIndex:"disabledFlag"},{title:"操作",dataIndex:"operate",width:60}]),L=g();async function B(){let e=(await a.getRoleAllEmployee(M.value)).data.map((e=>e.employeeId))||[];L.value.showModal(e)}async function G(t){if(e.isEmpty(t))p.warning("请选择角色人员");else{r.show();try{let e={employeeIdList:t,roleId:M.value};await a.batchAddRoleEmployee(e),p.success("添加成功"),await J()}catch(o){l.captureError(o)}finally{r.hide()}}}const H=g([]),Q=v((()=>H.value.length>0));function V(e){H.value=e}function $(){Q.value?d.confirm({title:"提示",content:"确定移除这些角色成员吗？",okText:"确定",okType:"danger",async onOk(){r.show();try{let e={employeeIdList:H.value,roleId:M.value};await a.batchRemoveRoleEmployee(e),p.success("移除成功"),H.value=[],await J()}catch(e){l.captureError(e)}finally{r.hide()}},cancelText:"取消",onCancel(){}}):p.warning("请选择要删除的角色成员")}return(e,t)=>{const o=j("a-input"),c=j("a-button"),u=j("a-tag"),m=j("a-table"),y=j("a-pagination"),g=f("privilege");return w(),h("div",null,[b("div",N,[b("div",null,[x(" 关键字： "),k(o,{style:{width:"250px"},value:O.keywords,"onUpdate:value":t[0]||(t[0]=e=>O.keywords=e),placeholder:"姓名/手机号/登录账号"},null,8,["value"]),S(M)?(w(),I(c,{key:0,class:"button-style",type:"primary",onClick:F},{default:E((()=>[x("搜索")])),_:1})):z("",!0),S(M)?(w(),I(c,{key:1,class:"button-style",type:"default",onClick:A},{default:E((()=>[x("重置")])),_:1})):z("",!0)]),b("div",null,[S(M)?C((w(),I(c,{key:0,class:"button-style",type:"primary",onClick:B},{default:E((()=>[x("添加员工")])),_:1})),[[g,"system:role:employee:add"]]):z("",!0),S(M)?C((w(),I(c,{key:1,class:"button-style",type:"primary",danger:"",onClick:$},{default:E((()=>[x("批量移除")])),_:1})),[[g,"system:role:employee:batch:delete"]]):z("",!0)])]),k(m,{loading:q.value,dataSource:U.value,columns:K,pagination:!1,scroll:{y:400},rowKey:"employeeId","row-selection":{selectedRowKeys:H.value,onChange:V},size:"small",bordered:""},{bodyCell:E((({text:t,record:o,column:s})=>["disabledFlag"===s.dataIndex?(w(),I(u,{key:0,color:t?"error":"processing"},{default:E((()=>[x(_(t?"禁用":"启用"),1)])),_:2},1032,["color"])):"gender"===s.dataIndex?(w(),h("span",R,_(e.$smartEnumPlugin.getDescByValue("GENDER_ENUM",t)),1)):z("",!0),"operate"===s.dataIndex?C((w(),h("a",{key:2,onClick:e=>async function(e){d.confirm({title:"提示",content:"确定要删除该角色成员么？",okText:"确定",okType:"danger",async onOk(){r.show();try{await a.deleteEmployeeRole(e,M.value),p.success("移除成功"),await J()}catch(t){l.captureError(t)}finally{r.hide()}},cancelText:"取消",onCancel(){}})}(o.employeeId)},[x("移除")],8,T)),[[g,"system:role:employee:delete"]]):z("",!0)])),_:1},8,["loading","dataSource","columns","row-selection"]),b("div",D,[k(y,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:S(i),defaultPageSize:O.pageSize,current:O.pageNum,"onUpdate:current":t[1]||(t[1]=e=>O.pageNum=e),pageSize:O.pageSize,"onUpdate:pageSize":t[2]||(t[2]=e=>O.pageSize=e),total:P.value,onChange:J,onShowSizeChange:J,"show-total":S(s)},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])]),k(n,{ref_key:"selectEmployeeModal",ref:L,onSelectData:G},null,512)])}}},[["__scopeId","data-v-db8ea612"]]);export{M as default};
