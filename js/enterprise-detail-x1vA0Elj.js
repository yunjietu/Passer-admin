import{_ as e}from"./lodash-DJa03WnC.js";import{a}from"./vue-router-BJIyZwNj.js";import t from"./enterprise-bank-list-CMTGq4iJ.js";import r from"./enterprise-employee-list-DsEjVsDd.js";import l from"./enterprise-invoice-list-B7d7M8oG.js";import i from"./enterprise-operate-modal-uFOhXTeE.js";import{e as s}from"./enterprise-api-BssaVI4u.js";import{p as o,_ as n,c as d,P as p,s as u,S as m}from"./index-ZxpkwSGJ.js";import{c}from"./diff-BE8ux7Aj.js";import{h as f}from"./diff2html-Cjc1Nsmf.js";import{u as v}from"./ua-parser-js-BGt8dhPM.js";import{b2 as y,ag as j,o as b,bz as g,b as _,F as h,b0 as w,ai as k,ah as S,be as I,a as N,r as z,w as L,c as O,J as E,u as q,n as x,e as C,m as T}from"./@vue-wTDZSr7R.js";import{_ as A}from"./index-CAEs7VG8.js";import"./@ant-design-rHMPkvPq.js";import"./vue-DiME50Ru.js";import"./@ctrl-B1U3vBhl.js";import"./enterprise-bank-operate-modal-Ck2AC6fB.js";import"./ant-design-vue-DFQN5xdf.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-COtJ1lvC.js";import"./stylis-Bzr8AwGH.js";import"./vue-types-BvQfMnDx.js";import"./dom-align-CCb293uS.js";import"./lodash-es-DiERF9Dp.js";import"./dayjs-CSPdbndm.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./index-wy53HiSK.js";import"./sortablejs-CRp0PNdb.js";/* empty css                                                                                 */import"./table-id-const-CfofKxZg.js";import"./index-0_dkeot7.js";import"./index-YdqzJmk0.js";import"./department-api-BBQ_I4Vj.js";import"./enterprise-invoice-operate-modal-BD1Ous4w.js";import"./regular-const-BsnQI0fZ.js";import"./index-DPBcXeae.js";import"./vue3-json-viewer-BcgvkQJY.js";import"./vue-i18n-DNlNJnDH.js";import"./@intlify-BXJl0ReV.js";import"./pinia-BY_IhmGU.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-VShT-BxW.js";import"./sm-crypto-BtLvRUKc.js";import"./jsbn-qAKIvbVZ.js";import"./nprogress-DmlD4NmX.js";import"./mitt-CNZ6avp8.js";import"./hogan.js-C2UNKCU2.js";
/*
 * 数据变动
 *
 * @Author:    小何
 * @Date:      2022-09-03 21:51:54
 * @Wechat:    zhuda1024
 * @Email:     lab1024@163.com
 * @Copyright  1024创新实验室 （ https://1024lab.net ），Since 2012
 */const D=e=>o("/support/dataTracer/query",e),R={class:"trace-div"},$=["innerHTML"],M=["onClick"],P={class:"ip-font"},U=n({__name:"data-tracer-timeline",props:{tableData:{type:Array}},emits:["showDetail"],setup(e,{emit:a}){const t=a;return(a,r)=>{const l=y("a-timeline-item"),i=y("a-timeline");return b(),j(i,null,{default:g((()=>[(b(!0),_(h,null,w(e.tableData,(e=>(b(),j(l,{key:e.dataTracerId},{default:g((()=>[k("div",R,[k("div",null,[k("div",{class:"operate-content",innerHTML:e.content},null,8,$),e.diffOld||e.diffNew?(b(),_("a",{key:0,href:"javascript:void(0)",onClick:a=>function(e){t("showDetail",e)}(e)},"（查看修改）",8,M)):S("",!0)]),k("div",P,I(e.createTime)+" | "+I(e.userName)+" | "+I(e.ipRegion)+" | "+I(e.ip)+" | "+I(e.browser)+" | "+I(e.os),1)])])),_:2},1024)))),128))])),_:1})}}},[["__scopeId","data-v-f261fd2c"]]),H=["innerHTML"],F={__name:"index",props:{dataId:{type:Number},type:{type:Number}},setup(e){let a=e;const t={pageNum:1,pageSize:d,searchCount:!0,keywords:void 0},r=N({...t}),l=z(!1),i=z([]),s=z(0);function o(){Object.assign(r,t),n()}function n(){r.pageNum=1,m()}async function m(){try{l.value=!0;let e=await D(Object.assign({},r,{dataId:a.dataId,type:a.type}));for(const a of e.data.list){if(!a.userAgent)continue;let e=v(a.userAgent);a.browser=e.browser.name,a.os=e.os.name,a.device=e.device.vendor?e.device.vendor+e.device.model:""}const t=e.data.list;s.value=e.data.total,i.value=t}catch(e){u.captureError(e)}finally{l.value=!1}}L((()=>a.dataId),(e=>{e&&(r.dataId=e,n())}),{immediate:!0});const j=z(!1);let w=z("");function S(e){j.value=!0;let a=e.diffOld.replaceAll("<br/>","\r\n"),t=e.diffNew.replaceAll("<br/>","\r\n");let r=c(...["",a,t,"变更前","变更后"]),l=f(r,{drawFileList:!1,matching:"words",diffMaxChanges:1e3,outputFormat:"side-by-side"});w.value=l,x((()=>{let e=document.querySelectorAll(".d2h-file-side-diff");if(e.length>0){let a=e[0],t=e[1];a.addEventListener("scroll",(function(e){a.scrollLeft!==t.scrollLeft&&(t.scrollLeft=a.scrollLeft)})),t.addEventListener("scroll",(function(e){a.scrollLeft!==t.scrollLeft&&(a.scrollLeft=t.scrollLeft)}))}}))}return(e,a)=>{const t=y("a-input"),l=y("a-form-item"),d=y("SearchOutlined"),u=y("a-button"),c=y("ReloadOutlined"),f=y("a-button-group"),v=y("a-row"),I=y("a-form"),N=y("a-pagination"),z=y("a-modal"),L=y("a-card");return b(),_(h,null,[O(I,{class:"smart-query-form"},{default:g((()=>[O(v,{class:"smart-query-form-row"},{default:g((()=>[O(l,{label:"关键字",class:"smart-query-form-item"},{default:g((()=>[O(t,{style:{width:"300px"},value:r.keywords,"onUpdate:value":a[0]||(a[0]=e=>r.keywords=e),placeholder:"变更内容"},null,8,["value"])])),_:1}),O(l,{class:"smart-query-form-item smart-margin-left10"},{default:g((()=>[O(f,null,{default:g((()=>[O(u,{type:"primary",onClick:n},{icon:g((()=>[O(d)])),default:g((()=>[E(" 查询 ")])),_:1}),O(u,{onClick:o},{icon:g((()=>[O(c)])),default:g((()=>[E(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),O(L,{size:"small",bordered:!1},{default:g((()=>[O(U,{tableData:i.value,onShowDetail:S},null,8,["tableData"]),O(N,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:q(p),defaultPageSize:r.pageSize,current:r.pageNum,"onUpdate:current":a[1]||(a[1]=e=>r.pageNum=e),pageSize:r.pageSize,"onUpdate:pageSize":a[2]||(a[2]=e=>r.pageSize=e),total:s.value,onChange:m,onShowSizeChange:m,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"]),O(z,{open:j.value,"onUpdate:open":a[3]||(a[3]=e=>j.value=e),width:"90%",title:"数据比对",footer:null},{default:g((()=>[k("div",{innerHTML:q(w)},null,8,H)])),_:1},8,["open"])])),_:1})],64)}}},B={GOODS:{value:1,desc:"商品"},OA_NOTICE:{value:2,desc:"OA-通知公告"},OA_ENTERPRISE:{value:3,desc:"OA-企业信息"}},J="/png/logo-gs-65BojZT_.png",G={class:"detail-header"},Q=n({__name:"enterprise-detail",setup(o){const n=a();let d=z();C((()=>{n.query.enterpriseId&&(d.value=Number(n.query.enterpriseId),v())}));const p=z();function c(){p.value.showModal(d.value)}let f=z({});async function v(){try{let e=await s.detail(d.value);f.value=e.data}catch(e){u.captureError(e)}finally{m.hide()}}const w=T((()=>{let e="";return f.value?(f.value.provinceName&&(e+=f.value.provinceName),f.value.cityName&&(e+=f.value.cityName),f.value.districtName&&(e+=f.value.districtName),e):e})),N=T((()=>f.value?e.isEmpty(f.value.enterpriseLogo)?J:f.value.enterpriseLogo[0].fileUrl:J));return(e,a)=>{const s=y("a-button"),o=y("a-descriptions-item"),n=y("a-descriptions"),u=y("a-page-header"),m=y("a-tab-pane"),z=y("a-tabs"),L=y("a-card");return b(),_(h,null,[k("div",G,[O(u,{title:q(f).enterpriseName,avatar:{src:N.value}},{extra:g((()=>[O(s,{onClick:c,type:"primary"},{default:g((()=>[E("编辑")])),_:1})])),default:g((()=>[k("div",null,[O(n,{size:"small",column:3},{default:g((()=>[O(o,{label:"统一社会信用代码"},{default:g((()=>[E(I(q(f).unifiedSocialCreditCode),1)])),_:1}),O(o,{label:"联系人"},{default:g((()=>[E(I(q(f).contact),1)])),_:1}),O(o,{label:"联系人电话"},{default:g((()=>[E(I(q(f).contactPhone),1)])),_:1}),O(o,{label:"邮箱"},{default:g((()=>[E(I(q(f).email),1)])),_:1}),O(o,{label:"所在城市"},{default:g((()=>[E(I(w.value),1)])),_:1}),O(o,{label:"详细地址"},{default:g((()=>[E(I(q(f).address),1)])),_:1}),O(o,{label:"创建时间"},{default:g((()=>[E(I(q(f).createTime),1)])),_:1}),O(o,{label:"创建人"},{default:g((()=>[E(I(q(f).createUserName),1)])),_:1}),O(o,{label:"营业执照"},{default:g((()=>[O(A,{"file-list":q(f).businessLicense},null,8,["file-list"])])),_:1})])),_:1})])])),_:1},8,["title","avatar"])]),e.$privilege("oa:enterprise:queryEmployee")||e.$privilege("oa:bank:query")||e.$privilege("oa:invoice:query")?(b(),j(L,{key:0,class:"smart-margin-top10",size:"small"},{default:g((()=>[O(z,null,{default:g((()=>[e.$privilege("oa:enterprise:queryEmployee")?(b(),j(m,{key:"employee",tab:"员工信息"},{default:g((()=>[O(r,{enterpriseId:q(d)},null,8,["enterpriseId"])])),_:1})):S("",!0),e.$privilege("oa:bank:query")?(b(),j(m,{key:"bank",tab:"银行信息"},{default:g((()=>[O(t,{enterpriseId:q(d)},null,8,["enterpriseId"])])),_:1})):S("",!0),e.$privilege("oa:invoice:query")?(b(),j(m,{key:"invoice",tab:"发票信息"},{default:g((()=>[O(l,{enterpriseId:q(d)},null,8,["enterpriseId"])])),_:1})):S("",!0),O(m,{key:"dataTracer",tab:"变更记录"},{default:g((()=>[O(F,{dataId:q(d),type:q(B).OA_ENTERPRISE.value},null,8,["dataId","type"])])),_:1})])),_:1}),O(i,{ref_key:"operateRef",ref:p,onRefresh:v},null,512)])),_:1})):S("",!0)],64)}}},[["__scopeId","data-v-e9bd01e1"]]);export{Q as default};
